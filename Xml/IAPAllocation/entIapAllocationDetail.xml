<entity ID="entIapAllocationDetail" sfwMainCDO="icdoIapAllocationDetail" sfwType="BusinessRule" sfwActive="True" sfwStatus="Review" sfwObjectID="busIapAllocationDetail" sfwTableName="sgt_iap_allocation_detail" sfwView="False" sfwDataObjectID="doIapAllocationDetail">
  <queries>
    <query ID="LoadSummaryForYearEndAllocation" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DECLARE @LATE_ELIGIBLE_HOURS NUMERIC(11,2)&#xD;&#xA;DECLARE @LATE_ELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT NUMERIC(11,2)&#xD;&#xA;DECLARE @LATE_ELGIBILE_COMPENSATION_AMOUNT NUMERIC(11,2)&#xD;&#xA;&#xD;&#xA;DECLARE @LATE_HOURS NUMERIC(11,2)&#xD;&#xA;DECLARE @LATE_HOURLY_CONTRIBUTION_AMOUNT NUMERIC(11,2)&#xD;&#xA;DECLARE @LATE_COMPENSATION_AMOUNT NUMERIC(11,2)&#xD;&#xA;&#xD;&#xA;DECLARE @CURRENT_HOURS NUMERIC(11,2)&#xD;&#xA;DECLARE @CURRENT_HOURLY_CONTRIBUTION_AMOUNT NUMERIC(11,2)&#xD;&#xA;DECLARE @CURRENT_COMPENSATION_AMOUNT NUMERIC(11,2)&#xD;&#xA;&#xD;&#xA;SELECT @LATE_ELIGIBLE_HOURS = SUM(ISNULL(IAPHOURSA2,0)),@LATE_ELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT = SUM(ISNULL(IAPHOURSA2 * 0.305,0)) ,&#xD;&#xA;@LATE_ELGIBILE_COMPENSATION_AMOUNT = SUM(ISNULL(IAPPERCENT,0))&#xD;&#xA;FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE LATE_FLAG = 'Y' AND&#xD;&#xA;SSN IN&#xD;&#xA;(&#xD;&#xA;SELECT SSN&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL IAD&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON IAD.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SP.PERSON_ID = SPA.PERSON_ID WHERE &#xD;&#xA;(ISNULL(LATE_ALLOC1_AMOUNT,0) &lt;&gt; 0 OR ISNULL(LATE_ALLOC2_AMOUNT,0) &lt;&gt; 0 OR ISNULL(LATE_ALLOC3_AMOUNT,0) &lt;&gt; 0 OR&#xD;&#xA;ISNULL(LATE_ALLOC4_AMOUNT,0) &lt;&gt; 0 OR ISNULL(LATE_ALLOC5_AMOUNT,0) &lt;&gt; 0) AND IAD.COMPUTATION_YEAR = @ALLOCATIONYEAR&#xD;&#xA;GROUP BY SSN&#xD;&#xA;)&#xD;&#xA;GROUP BY LATE_FLAG&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SELECT @LATE_HOURS = SUM(ISNULL(IAPHOURSA2,0)),@LATE_HOURLY_CONTRIBUTION_AMOUNT = SUM(ISNULL(IAPHOURSA2 * 0.305,0)) ,&#xD;&#xA;@LATE_COMPENSATION_AMOUNT = SUM(ISNULL(IAPPERCENT,0))&#xD;&#xA;FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE LATE_FLAG = 'Y'&#xD;&#xA;&#xD;&#xA;SELECT @CURRENT_HOURS = SUM(ISNULL(IAPHOURSA2,0)),@CURRENT_HOURLY_CONTRIBUTION_AMOUNT = SUM(ISNULL(IAPHOURSA2 * 0.305,0)) ,&#xD;&#xA;@CURRENT_COMPENSATION_AMOUNT = SUM(ISNULL(IAPPERCENT,0))&#xD;&#xA;FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE LATE_FLAG = 'N'&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SELECT  COMPUTATION_YEAR,&#xD;&#xA;   SUM(ISNULL(SYSTEM_BEGINNING_BALANCE,0.00)+ ISNULL(L52_SPECIAL_ACCOUNT_AMOUNT,0.00) + ISNULL(L161_SPECIAL_ACCOUNT_AMOUNT,0.00)) AS SYSTEM_BEGINNING_BALANCE,&#xD;&#xA;   SUM(ISNULL(FORFEITED_BALANCE,0.00)) AS FORFEITED_BALANCE,&#xD;&#xA;   SUM(ISNULL(LATE_ALLOC1_AMOUNT,0.00)) AS LATE_ALLOC1_AMOUNT,&#xD;&#xA;   SUM(ISNULL(LATE_ALLOC2_AMOUNT,0.00)) AS LATE_ALLOC2_AMOUNT,&#xD;&#xA;   SUM(ISNULL(LATE_ALLOC3_AMOUNT,0.00)) AS LATE_ALLOC3_AMOUNT,&#xD;&#xA;   SUM(ISNULL(LATE_ALLOC4_AMOUNT,0.00)) AS LATE_ALLOC4_AMOUNT,&#xD;&#xA;   SUM(ISNULL(LATE_ALLOC5_AMOUNT,0.00)) AS LATE_ALLOC5_AMOUNT,&#xD;&#xA;   SUM(ISNULL(QUATERLY_ALLOCATIONS_AMOUNT,0.00)) AS QUATERLY_ALLOCATIONS_AMOUNT,&#xD;&#xA;   SUM(ISNULL(RETIREMENT_YEAR_ALLOCATION2_AMOUNT,0.00)) AS RETIREMENT_YEAR_ALLOCATION2_AMOUNT,&#xD;&#xA;   SUM(ISNULL(RETIREMENT_YEAR_ALLOCATION4_AMOUNT,0.00)) AS RETIREMENT_YEAR_ALLOCATION4_AMOUNT,&#xD;&#xA;   SUM(ISNULL(PAYOUTS,0.00)) AS PAYOUTS,&#xD;&#xA;   SUM(ISNULL(UNALLOCABLE_AMOUNT,0.00)) AS UNALLOCABLE_AMOUNT,&#xD;&#xA;   ISNULL(@LATE_HOURS,0) - ISNULL(@LATE_ELIGIBLE_HOURS,0) AS LATE_INELIGIBLE_HOURS,&#xD;&#xA;   ISNULL(@LATE_HOURLY_CONTRIBUTION_AMOUNT,0) - ISNULL(@LATE_ELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT,0) AS LATE_INELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT,&#xD;&#xA;   SUM(ISNULL(CURRENT_YEAR_INELIGIBLE_HOURS,0.00)) AS CURRENT_YEAR_INELIGIBLE_HOURS,&#xD;&#xA;   @CURRENT_HOURLY_CONTRIBUTION_AMOUNT - SUM(ISNULL(HOURLY_CONTRIBUTION_AMOUNT,0.00)) - SUM(ISNULL(RETIREMENT_YEAR_ALLOCATION2_AMOUNT,0.00)) AS CURRENT_YEAR_INELIGIBLE_CONTRIBUTION_AMOUNT,&#xD;&#xA;   SUM(ISNULL(ELIGIBLE_HOURS,0.00)) AS ELIGIBLE_HOURS,&#xD;&#xA;   SUM(ISNULL(HOURLY_CONTRIBUTION_AMOUNT,0.00)) AS HOURLY_CONTRIBUTION_AMOUNT,&#xD;&#xA;   SUM(ISNULL(TOTAL_IAP_HOURS,0.00)) AS TOTAL_IAP_HOURS,&#xD;&#xA;   ISNULL(@LATE_COMPENSATION_AMOUNT,0) - ISNULL(@LATE_ELGIBILE_COMPENSATION_AMOUNT,0) AS LATE_INELGIBILE_COMPENSATION_AMOUNT,&#xD;&#xA;   (@CURRENT_COMPENSATION_AMOUNT - &#xD;&#xA;    SUM(CASE WHEN ((IAP_ALLOCATION_CATEGORY_VALUE IN ('ACTV','NEWP','ACTD','EIAP','MDAR','MDNW','DROA') AND (ISNULL(TOTAL_IAP_HOURS,0)) &gt;= 400)&#xD;&#xA;    OR (IAP_ALLOCATION_CATEGORY_VALUE IN ('RU65','RO65') AND (ISNULL(TOTAL_IAP_HOURS,0)) &gt;= 870)) &#xD;&#xA;    THEN (ISNULL(PERCENTAGE_OF_COMPENSATION_AMOUNT,0.00)) ELSE 0.00 END) &#xD;&#xA;   - SUM(ISNULL(RETIREMENT_YEAR_ALLOCATION4_AMOUNT,0.00))&#xD;&#xA;   - SUM(ISNULL(OVERLIMIT_CONTRIBUTIONS_AMOUNT,0.00)))  AS CURRENT_YEAR_INELGIBILE_COMPENSATION_AMOUNT,&#xD;&#xA;   SUM(ISNULL(OVERLIMIT_CONTRIBUTIONS_AMOUNT,0.00)) AS OVERLIMIT_CONTRIBUTIONS_AMOUNT,&#xD;&#xA;   SUM(CASE WHEN ((IAP_ALLOCATION_CATEGORY_VALUE IN ('ACTV','NEWP','ACTD','EIAP','MDAR','MDNW','DROA') AND (ISNULL(TOTAL_IAP_HOURS,0)) &gt;= 400)&#xD;&#xA;    OR (IAP_ALLOCATION_CATEGORY_VALUE IN ('RU65','RO65') AND (ISNULL(TOTAL_IAP_HOURS,0)) &gt;= 870)) &#xD;&#xA;    THEN (ISNULL(PERCENTAGE_OF_COMPENSATION_AMOUNT,0.00)) ELSE 0.00 END) AS PERCENTAGE_OF_COMPENSATION_AMOUNT,&#xD;&#xA;   ISNULL(@LATE_ELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT,0) AS LATE_ELIGIBLE_HOURLY_CONTRIBUTION_AMOUNT,&#xD;&#xA;   ISNULL(@LATE_ELGIBILE_COMPENSATION_AMOUNT,0) AS LATE_ELIGIBLE_COMPENSATION_AMOUNT&#xD;&#xA;FROM  SGT_IAP_ALLOCATION_DETAIL WITH(NOLOCK)&#xD;&#xA;WHERE  COMPUTATION_YEAR = @ALLOCATIONYEAR&#xD;&#xA;GROUP BY COMPUTATION_YEAR&#xD;&#xA;">
      <parameters>
        <parameter ID="@ALLOCATIONYEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadIAPAllocationDetailForPosting" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT *&#xD;&#xA;FROM  SGT_IAP_ALLOCATION_DETAIL WITH(NOLOCK)&#xD;&#xA;WHERE  COMPUTATION_YEAR = @COMPUTATIONYEAR&#xD;&#xA;AND  (ALLOCATION1_AMOUNT IS NOT NULL OR ALLOCATION2_AMOUNT IS NOT NULL OR ALLOCATION2_FRFT_AMOUNT IS NOT NULL OR ALLOCATION2_INVST_AMOUNT IS NOT NULL OR &#xD;&#xA;   ALLOCATION4_AMOUNT IS NOT NULL OR ALLOCATION4_FRFT_AMOUNT IS NOT NULL OR ALLOCATION4_INVST_AMOUNT IS NOT NULL&#xD;&#xA;    OR L52_ALLOCATION1_AMOUNT IS NOT NULL OR L161_ALLOCATION1_AMOUNT IS NOT NULL)">
      <parameters>
        <parameter ID="@COMPUTATIONYEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="DeletePreviousYearData" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DELETE FROM SGT_IAP_ALLOCATION_DETAIL">
      <parameters />
    </query>
    <query ID="LoadCategoryInfobyPersonAccountID" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PA.PERSON_ACCOUNT_ID,PA.STATUS_VALUE,PAE.VESTED_DATE,PBF.BIS_FLAG FROM SGT_PERSON_ACCOUNT PA&#xD;&#xA;LEFT OUTER JOIN SGT_PERSON_ACCOUNT_ELIGIBILITY PAE ON PA.PERSON_ACCOUNT_ID=PAE.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON P ON P.PERSON_ID=PA.PERSON_ID&#xD;&#xA;LEFT OUTER JOIN SGT_PERSON_BATCH_FLAGS PBF ON PBF.PERSON_ID=P.PERSON_ID&#xD;&#xA;WHERE PA.PERSON_ACCOUNT_ID=@PERSON_ACCOUNT_ID&#xD;&#xA;">
      <parameters>
        <parameter ID="@PERSON_ACCOUNT_ID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetMaxAllocationYear" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select top 1 * from SGT_IAP_ALLOCATION_SUMMARY order by COMPUTATION_YEAR desc">
      <parameters />
    </query>
    <query ID="GetAllWorkHistory4IAPSnapShot" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE SSN = @SSN  --PIR 886&#xD;&#xA;ORDER BY COMPUTATIONYEAR">
      <parameters>
        <parameter ID="@SSN" sfwDataType="string" />
      </parameters>
    </query>
    <query ID="UpdateIAPHoursA2AndIAPPercent" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="UPDATE IDA SET LATE_HOURLY_CONTRIBUTION = (SELECT SUM(ISNULL(IAPHOURSA2,0) * 0.305) FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE LATE_FLAG = 'Y' AND SSN = SP.SSN) , &#xD;&#xA;LATE_SALARY_COMPENSATION = (SELECT SUM(ISNULL(IAPPERCENT,0)) FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT WHERE LATE_FLAG = 'Y' AND SSN = SP.SSN)   &#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL(nolock) IDA&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT(nolock) SPA ON IDA.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON SP(nolock) ON SPA.PERSON_ID = SP.PERSON_ID&#xD;&#xA;WHERE IDA.FUND_TYPE = 'IAP' AND IDA.COMPUTATION_YEAR = @COMPUTATION_YEAR">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdateIAPHoursA2AndIAPPercentInSummary" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="UPDATE IDS SET &#xD;&#xA;LATE_HOURLY_CONTRIBUTION = (SELECT SUM(ISNULL(IAD.LATE_HOURLY_CONTRIBUTION,0)) FROM SGT_IAP_ALLOCATION_DETAIL IAD WHERE IAD.COMPUTATION_YEAR = IDS.COMPUTATION_YEAR),&#xD;&#xA;LATE_SALARY_COMPENSATION = (SELECT SUM(ISNULL(IAD.LATE_SALARY_COMPENSATION,0)) FROM SGT_IAP_ALLOCATION_DETAIL IAD WHERE IAD.COMPUTATION_YEAR = IDS.COMPUTATION_YEAR)&#xD;&#xA;FROM SGT_IAP_ALLOCATION_SUMMARY IDS WHERE IDS.COMPUTATION_YEAR = @COMPUTATION_YEAR">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdateBeginningBalances" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="UPDATE SGT_IAP_ALLOCATION_DETAIL  SET CURRENT_YR_BEGINNING_BALANCE = A.ENDBAL ,&#xD;&#xA;BEGINNING_BAL_ADJUSTMENT = CASE WHEN IAD.FUND_TYPE = 'IAP' THEN A.ENDBAL - IAD.SYSTEM_BEGINNING_BALANCE&#xD;&#xA;       WHEN IAD.FUND_TYPE = 'L052' THEN A.ENDBAL - IAD.L52_SPECIAL_ACCOUNT_AMOUNT&#xD;&#xA;       ELSE A.ENDBAL - IAD.L161_SPECIAL_ACCOUNT_AMOUNT END&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL IAD&#xD;&#xA;INNER JOIN &#xD;&#xA;(&#xD;&#xA;SELECT ID.SSN,&#xD;&#xA;CASE WHEN ID.[PLAN] = 1 THEN 'IAP' WHEN ID.[PLAN] = 7 THEN 'L052' ELSE 'L161' END FUND_TYPE ,&#xD;&#xA;SUM(ID.ENDBAL) ENDBAL,SPA.PERSON_ACCOUNT_ID FROM OPUS_CUSTOM..ALLOCMASTER_DETAIL_2013 ID&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SP.SSN = ID.SSN&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SPA.PERSON_ID = SP.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;WHERE YR=2012 AND ENDBAL &lt;&gt; 0.00&#xD;&#xA;GROUP BY ID.SSN , ID.[PLAN],SPA.PERSON_ACCOUNT_ID&#xD;&#xA;)A ON A.PERSON_ACCOUNT_ID = IAD.PERSON_ACCOUNT_ID AND IAD.FUND_TYPE = A.FUND_TYPE">
      <parameters />
    </query>
    <query ID="InsertMissingBeginningBalances" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_IAP_ALLOCATION_DETAIL (PERSON_ACCOUNT_ID , COMPUTATION_YEAR ,FUND_TYPE,&#xD;&#xA;CURRENT_YR_BEGINNING_BALANCE,BEGINNING_BAL_ADJUSTMENT,IAP_ALLOCATION_CATEGORY_ID,CREATED_BY,&#xD;&#xA;CREATED_DATE,MODIFIED_BY,MODIFIED_DATE,UPDATE_SEQ)&#xD;&#xA;SELECT A.PERSON_ACCOUNT_ID,@COMPUTATIONAL_YEAR,A.FUND_TYPE,A.ENDBAL,A.ENDBAL,1002,'YEAR_END_ALLOC_BATCH',GETDATE(),'YEAR_END_ALLOC_BATCH' ,&#xD;&#xA;GETDATE(),0 FROM&#xD;&#xA;(&#xD;&#xA;SELECT ID.SSN,&#xD;&#xA;CASE WHEN ID.[PLAN] = 1 THEN 'IAP' WHEN ID.[PLAN] = 7 THEN 'L052' ELSE 'L161' END FUND_TYPE ,&#xD;&#xA;SUM(ID.ENDBAL) ENDBAL,SPA.PERSON_ACCOUNT_ID FROM OPUS_CUSTOM..ALLOCMASTER_DETAIL_2013 ID&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SP.SSN = ID.SSN&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SPA.PERSON_ID = SP.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;WHERE YR=2012 AND ENDBAL &lt;&gt; 0.00&#xD;&#xA;GROUP BY ID.SSN , ID.[PLAN],SPA.PERSON_ACCOUNT_ID&#xD;&#xA;)A &#xD;&#xA;LEFT OUTER JOIN SGT_IAP_ALLOCATION_DETAIL IAD&#xD;&#xA;ON A.PERSON_ACCOUNT_ID = IAD.PERSON_ACCOUNT_ID AND IAD.FUND_TYPE = A.FUND_TYPE&#xD;&#xA;WHERE IAD.PERSON_ACCOUNT_ID IS NULL">
      <parameters>
        <parameter ID="@COMPUTATIONAL_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetManualAdjsAfterCutoff" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT SP.SSN,SPA.PERSON_ACCOUNT_ID,SUM(ISNULL(IAP_BALANCE_AMOUNT,0)) IAP_BALANCE_AMOUNT,&#xD;&#xA;SUM(ISNULL(LOCAL52_SPECIAL_ACCT_BAL_AMOUNT,0)) LOCAL52_SPECIAL_ACCT_BAL_AMOUNT,&#xD;&#xA;SUM(ISNULL(LOCAL161_SPECIAL_ACCT_BAL_AMOUNT,0))LOCAL161_SPECIAL_ACCT_BAL_AMOUNT&#xD;&#xA;FROM SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION RC&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON RC.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SP.PERSON_ID = SPA.PERSON_ID  AND PLAN_ID =  1&#xD;&#xA;WHERE TRANSACTION_TYPE_VALUE IN ('QALC','RETR') AND TRANSACTION_DATE BETWEEN '05/01/2014' AND GETDATE()&#xD;&#xA;GROUP BY SP.SSN,SPA.PERSON_ACCOUNT_ID">
      <parameters />
    </query>
    <query ID="CheckRetiremntYearRU65" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT TOP(1) YEAR(SBA.RETIREMENT_DATE) FROM SGT_BENEFIT_APPLICATION SBA&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SBA.PERSON_ID = SP.PERSON_ID AND APPLICATION_STATUS_VALUE = 'APPR'&#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL SBAD ON SBAD.BENEFIT_APPLICATION_ID = SBA.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR X ON X.PLAN_BENEFIT_ID = SBAD.PLAN_BENEFIT_ID AND PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA ON PA.PERSON_ID = SBA.PERSON_ID AND PA.PLAN_ID = 1&#xD;&#xA;WHERE PA.PERSON_ACCOUNT_ID = @PERSON_ACCOUNT_ID&#xD;&#xA;ORDER BY SBA.RETIREMENT_DATE DESC">
      <parameters>
        <parameter ID="@PERSON_ACCOUNT_ID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetAllFullWorkHistory4IAPSnapShot" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * FROM SGT_ALL_IAP_FULL_WORKHISTORY_4_SNAPSHOT WHERE SSN = @SSN&#xD;&#xA;ORDER BY COMPUTATIONYEAR">
      <parameters>
        <parameter ID="@SSN" sfwDataType="string" />
      </parameters>
    </query>
    <query ID="GetEACutoffDate" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT pe.cutoffdate from PILLARS.dbo.Period pe&#xD;&#xA;inner join PILLARS.dbo.Pensionyear py on py.enddate = pe.qualifyingenddate&#xD;&#xA;where py.pensionyear = @COMPUTATIONYEAR">
      <parameters>
        <parameter ID="@COMPUTATIONYEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdateEndingBalances" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT  A.SSN,A.FUND_TYPE,SUM(ISNULL(A.IAP_ENDING_BALANCE,0))IAP_ENDING_BALANCE,&#xD;&#xA;SUM(ISNULL(A.L52_ENDING_BALANCE,0))L52_ENDING_BALANCE,&#xD;&#xA;SUM(ISNULL(A.L161_ENDING_BALANCE,0))L161_ENDING_BALANCE&#xD;&#xA;INTO #TEMP&#xD;&#xA;FROM &#xD;&#xA;(&#xD;&#xA;SELECT D.FUND_TYPE,&#xD;&#xA;CONVERT(VARCHAR(9),CASE WHEN SP.IS_PERSON_DELETED_FLAG = 'Y' THEN  H.NEW_SSN ELSE SP.SSN END) SSN,&#xD;&#xA;D.PERSON_ACCOUNT_ID,&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'IAP'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(system_beginning_balance,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(ALLOCATION1_AMOUNT,0) + ISNULL(ALLOCATION2_AMOUNT,0) + ISNULL(ALLOCATION2_FRFT_AMOUNT,0)+ ISNULL(ALLOCATION2_INVST_AMOUNT,0)+ISNULL(ALLOCATION4_AMOUNT,0)+&#xD;&#xA;ISNULL(ALLOCATION4_FRFT_AMOUNT,0)+ISNULL(ALLOCATION4_INVST_AMOUNT,0)) ELSE 0 END AS IAP_ENDING_BALANCE,&#xD;&#xA;&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'L052'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(L52_SPECIAL_ACCOUNT_AMOUNT,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(L52_ALLOCATION1_AMOUNT,0)) ELSE 0 END L52_ENDING_BALANCE,&#xD;&#xA;&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'L161'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(L161_SPECIAL_ACCOUNT_AMOUNT,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(L161_ALLOCATION1_AMOUNT,0)) ELSE 0 END L161_ENDING_BALANCE&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL D&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SPA.PERSON_ACCOUNT_ID = D.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON_BASE SP ON SP.PERSON_ID = SPA.PERSON_ID&#xD;&#xA;LEFT OUTER JOIN SGT_SSN_MERGE_HISTORY H ON SP.PERSON_ID = H.OLD_PERSON_ID AND SP.IS_PERSON_DELETED_FLAG = 'Y'&#xD;&#xA;WHERE d.COMPUTATION_YEAR = @COMPUTATION_YEAR -1&#xD;&#xA;GROUP BY D.FUND_TYPE,sp.MPI_PERSON_ID,D.PERSON_ACCOUNT_ID,SP.IS_PERSON_DELETED_FLAG, NEW_MPI_PERSON_ID,NEW_SSN,SP.SSN&#xD;&#xA;)A &#xD;&#xA;GROUP BY A.SSN,A.FUND_TYPE&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;UPDATE I SET I.PREV_YR_ENDING_BAL = T.IAP_ENDING_BALANCE , &#xD;&#xA;I.BEGINNING_BAL_ADJUSTMENT = T.IAP_ENDING_BALANCE - I.SYSTEM_BEGINNING_BALANCE&#xD;&#xA;FROM #TEMP T&#xD;&#xA;INNER JOIN SGT_PERSON SP ON T.SSN = SP.SSN&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SP.PERSON_ID = SPA.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_IAP_ALLOCATION_DETAIL I ON I.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;WHERE I.COMPUTATION_YEAR = @COMPUTATION_YEAR AND T.FUND_TYPE = 'IAP' AND I.FUND_TYPE = 'IAP'&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;UPDATE I SET I.PREV_YR_ENDING_BAL = T.L52_ENDING_BALANCE , &#xD;&#xA;I.BEGINNING_BAL_ADJUSTMENT = T.L52_ENDING_BALANCE - I.L52_SPECIAL_ACCOUNT_AMOUNT&#xD;&#xA;FROM #TEMP T&#xD;&#xA;INNER JOIN SGT_PERSON SP ON T.SSN = SP.SSN&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SP.PERSON_ID = SPA.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_IAP_ALLOCATION_DETAIL I ON I.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;WHERE I.COMPUTATION_YEAR = @COMPUTATION_YEAR AND T.FUND_TYPE = 'L052' AND I.FUND_TYPE = 'L052'&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;UPDATE I SET I.PREV_YR_ENDING_BAL = T.L161_ENDING_BALANCE , &#xD;&#xA;I.BEGINNING_BAL_ADJUSTMENT = T.L161_ENDING_BALANCE - I.L161_SPECIAL_ACCOUNT_AMOUNT&#xD;&#xA;FROM #TEMP T&#xD;&#xA;INNER JOIN SGT_PERSON SP ON T.SSN = SP.SSN&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SP.PERSON_ID = SPA.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_IAP_ALLOCATION_DETAIL I ON I.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;WHERE I.COMPUTATION_YEAR = @COMPUTATION_YEAR AND T.FUND_TYPE = 'L161' AND I.FUND_TYPE = 'L161'&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;UPDATE I SET I.ENDING_BALANCE = CASE WHEN I.FUND_TYPE = 'IAP' THEN AXA.IAP_ENDING_BALANCE &#xD;&#xA;         WHEN I.FUND_TYPE = 'L052' THEN AXA.L52_ENDING_BALANCE&#xD;&#xA;         WHEN I.FUND_TYPE = 'L161' THEN AXA.L161_ENDING_BALANCE ELSE NULL END&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL I&#xD;&#xA;INNER JOIN&#xD;&#xA;(&#xD;&#xA;SELECT PERSON_ACCOUNT_ID,D.FUND_TYPE ,&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'IAP'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(system_beginning_balance,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(ALLOCATION1_AMOUNT,0) + ISNULL(ALLOCATION2_AMOUNT,0) + ISNULL(ALLOCATION2_FRFT_AMOUNT,0)+ ISNULL(ALLOCATION2_INVST_AMOUNT,0)+ISNULL(ALLOCATION4_AMOUNT,0)+&#xD;&#xA;ISNULL(ALLOCATION4_FRFT_AMOUNT,0)+ISNULL(ALLOCATION4_INVST_AMOUNT,0)) ELSE 0 END AS IAP_ENDING_BALANCE,&#xD;&#xA;&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'L052'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(L52_SPECIAL_ACCOUNT_AMOUNT,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(L52_ALLOCATION1_AMOUNT,0)) ELSE 0 END L52_ENDING_BALANCE,&#xD;&#xA;&#xD;&#xA;CASE WHEN D.FUND_TYPE = 'L161'&#xD;&#xA;THEN&#xD;&#xA;SUM(ISNULL(L161_SPECIAL_ACCOUNT_AMOUNT,0) + ISNULL(late_alloc2_amount,0) + ISNULL(late_alloc4_amount,0) + &#xD;&#xA;ISNULL(quaterly_allocations_amount,0) + ISNULL(retirement_year_allocation2_amount,0) +  ISNULL(retirement_year_allocation4_amount,0) + &#xD;&#xA;ISNULL(payouts,0)  + ISNULL(forfeited_balance,0) + ISNULL(late_alloc1_amount,0) + ISNULL(late_alloc3_amount,0) + ISNULL(late_alloc5_amounT,0)&#xD;&#xA;+ ISNULL(L161_ALLOCATION1_AMOUNT,0)) ELSE 0 END L161_ENDING_BALANCE&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL D WHERE COMPUTATION_YEAR = @COMPUTATION_YEAR &#xD;&#xA;GROUP BY D.FUND_TYPE, D.PERSON_ACCOUNT_ID&#xD;&#xA;)AXA ON AXA.PERSON_ACCOUNT_ID = I.PERSON_ACCOUNT_ID AND AXA.FUND_TYPE = I.FUND_TYPE&#xD;&#xA;WHERE I.COMPUTATION_YEAR=@COMPUTATION_YEAR&#xD;&#xA; ">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="HoursForLastTwoYear" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--PIR 886&#xD;&#xA;IF OBJECT_ID('SGT_IAP_HOURS_FOR_LAST_TWO_YEARS') IS NOT NULL&#xD;&#xA;   BEGIN&#xD;&#xA;   TRUNCATE TABLE SGT_IAP_HOURS_FOR_LAST_TWO_YEARS&#xD;&#xA;END&#xD;&#xA;INSERT INTO SGT_IAP_HOURS_FOR_LAST_TWO_YEARS&#xD;&#xA;SELECT A.SSN,SUM(ISNULL(A.PREVIAPHOURS,0)) PREVIAPHOURS,SUM(ISNULL(A.CURRIAPHOURS,0))CURRIAPHOURS &#xD;&#xA;FROM&#xD;&#xA;(&#xD;&#xA;SELECT SSN,&#xD;&#xA;CASE WHEN  COMPUTATIONYEAR = @COMPUTATIONYEAR -1 THEN SUM(ISNULL(IAPHOURS,0)) ELSE 0 END PREVIAPHOURS,&#xD;&#xA;CASE WHEN COMPUTATIONYEAR = @COMPUTATIONYEAR THEN SUM(ISNULL(IAPHOURS,0)) ELSE 0 END CURRIAPHOURS&#xD;&#xA;FROM SGT_ALL_IAP_WORKHISTORY_4_SNAPSHOT A WHERE COMPUTATIONYEAR &gt;= @COMPUTATIONYEAR - 1 &#xD;&#xA;GROUP BY SSN,COMPUTATIONYEAR&#xD;&#xA;UNION &#xD;&#xA;SELECT SSN,&#xD;&#xA;CASE WHEN COMPUTATIONYEAR = @COMPUTATIONYEAR -1 THEN SUM(ISNULL(IAPHOURS,0)) ELSE 0 END PREVIAPHOURS,&#xD;&#xA;CASE WHEN COMPUTATIONYEAR = @COMPUTATIONYEAR THEN SUM(ISNULL(IAPHOURS,0)) ELSE 0 END CURRIAPHOURS&#xD;&#xA;FROM SGT_ALL_IAP_FULL_WORKHISTORY_4_SNAPSHOT_FOR_PREV_YEAR A WHERE COMPUTATIONYEAR &gt;= @COMPUTATIONYEAR - 1 &#xD;&#xA;GROUP BY SSN,COMPUTATIONYEAR&#xD;&#xA;)A&#xD;&#xA;GROUP BY SSN&#xD;&#xA;&#xD;&#xA;SELECT * FROM SGT_IAP_HOURS_FOR_LAST_TWO_YEARS">
      <parameters>
        <parameter ID="@COMPUTATIONYEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetHoursForLastTwoYearBySSN" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * FROM SGT_IAP_HOURS_FOR_LAST_TWO_YEARS WHERE SSN = @SSN">
      <parameters>
        <parameter ID="@SSN" sfwDataType="string" />
      </parameters>
    </query>
    <query ID="GetPensionLateHours" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DECLARE @startdate DATETIME &#xD;&#xA;DECLARE @enddate DATETIME &#xD;&#xA;DECLARE @yr INT &#xD;&#xA;&#xD;&#xA;if OBJECT_ID('TEMP_TABLE_LATE_IAP_ALLOC_BATCH') is not null&#xD;&#xA;DROP TABLE TEMP_TABLE_LATE_IAP_ALLOC_BATCH&#xD;&#xA;&#xD;&#xA;SELECT @STARTDATE = PE.CUTOFFDATE FROM PILLARS.DBO.PERIOD PE&#xD;&#xA;INNER JOIN PILLARS.DBO.PENSIONYEAR PY ON PY.ENDDATE = PE.QUALIFYINGENDDATE&#xD;&#xA;WHERE PY.PENSIONYEAR = YEAR(@BATCHRUNDATE) -2&#xD;&#xA;SET @STARTDATE = DATEADD(DAY,1, @STARTDATE)&#xD;&#xA;           &#xD;&#xA;SELECT @ENDDATE = PE.CUTOFFDATE FROM PILLARS.DBO.PERIOD PE&#xD;&#xA;INNER JOIN PILLARS.DBO.PENSIONYEAR PY ON PY.ENDDATE = PE.QUALIFYINGENDDATE&#xD;&#xA;WHERE PY.PENSIONYEAR = YEAR(@BATCHRUNDATE) -1&#xD;&#xA;&#xD;&#xA;SET @STARTDATE = DATEADD(D,1,@STARTDATE)&#xD;&#xA;SET @YR = YEAR(@ENDDATE) - 1&#xD;&#xA;&#xD;&#xA;SELECT DISTINCT SP.SSN , SP.PERSON_ID,SP.MPI_PERSON_ID,MIN(wh.ComputationYear) AS COMPUTATIONAL_YEAR,&#xD;&#xA;--Ticket - 61177&#xD;&#xA;SUM(CASE WHEN wh.RATEGROUP = 8 THEN wh.HOURSWORKED &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN wh.RATEGROUP = 66 OR wh.RATEGROUP = 42 THEN CONVERT(NUMERIC(7, 1), 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE CONVERT(NUMERIC(7, 1), wh.HOURSWORKED * wh.IsPension) END) AS LATE_HOURS,&#xD;&#xA;SUM(wh.IAPPercent) AS IAP_PERCENT&#xD;&#xA;INTO TEMP_TABLE_LATE_IAP_ALLOC_BATCH&#xD;&#xA;--FROM EADB..REPORT R&#xD;&#xA;--INNER JOIN EADB..HOURS H ON R.REPORTID = H.REPORTID&#xD;&#xA;FROM [PILLARS].[dbo].[MPI_WorkHistory] wh&#xD;&#xA;--Ticket - 61177&#xD;&#xA;--INNER JOIN&#xD;&#xA;--(&#xD;&#xA;--&#x9;Select RateGroup, Pension = case when PensionEmployee &gt; 0 or PensionEmployer &gt; 0 then 1 else 0 end, FromDate = min(FROMDATE),ToDate = max(TODATE)&#xD;&#xA;--&#x9;From(&#xD;&#xA;--&#x9;&#x9;&#x9;SELECT TMP.RateGroup, TMP.FromDate, TMP.ToDate,  &#xD;&#xA;--&#x9;&#x9;&#x9;PensionEmployee = isnull((select amount from eadb.dbo.RateItems where RGContractID = TMP.RGContractId and RateItemTypeId = 3),0),  &#xD;&#xA;--&#x9;&#x9;&#x9;PensionEmployer = isnull((select amount from eadb.dbo.RateItems where RGContractID = TMP.RGContractId and RateItemTypeId = 4),0)&#xD;&#xA;--&#x9;&#x9;&#x9;FROM eadb.dbo.Ratecontract TMP&#xD;&#xA;--&#x9;&#x9;&#x9;WHERE Composite &lt;&gt; 0 and RGContractID not in (860, 1129, 915, 948, 978, 979)  &#xD;&#xA;--)X&#xD;&#xA;--&#x9;group by RateGroup, PensionEmployee, PensionEmployer &#xD;&#xA;&#xD;&#xA;--)RGC ON R.RATEGROUP = RGC.RATEGROUP AND R.TODATE BETWEEN RGC.FROMDATE AND RGC.TODATE&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SP.mpi_PERSON_ID = wh.MPIPersonId&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON SPA.PERSON_ID = SP.PERSON_ID AND SPA.PLAN_ID = 1&#xD;&#xA;WHERE  wh.EMPACCOUNTNO NOT IN (14002,13363,3596,3597,12904) AND wh.HoursStatus = 0 AND wh.Processed BETWEEN @STARTDATE AND @ENDDATE  AND wh.ComputationYear &lt; @YR &#xD;&#xA;GROUP BY SP.SSN,SP.PERSON_ID,SP.MPI_PERSON_ID &#xD;&#xA;HAVING SUM(CASE WHEN wh.RATEGROUP = 8 THEN wh.HOURSWORKED &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN wh.RATEGROUP = 66 OR wh.RATEGROUP = 42 THEN CONVERT(NUMERIC(7, 1), 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE CONVERT(NUMERIC(7, 1), wh.HOURSWORKED * wh.IsPension) END) &lt;&gt; 0 &#xD;&#xA;&#x9;  OR SUM(wh.IAPPercent) &lt;&gt; 0&#xD;&#xA;&#xD;&#xA;SELECT * FROM TEMP_TABLE_LATE_IAP_ALLOC_BATCH">
      <parameters>
        <parameter ID="@BatchRunDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="GetIAPBalanceUptoYear" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="IF @RETIREE = 1&#xD;&#xA;BEGIN&#xD;&#xA;SELECT      MAX(COMPUTATIONAL_YEAR) AS COMPUTATIONAL_YEAR,&#xD;&#xA;            SUM(ISNULL(IAP_BALANCE_AMOUNT,0))IAP_BALANCE_AMOUNT&#xD;&#xA;FROM        SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION WITH(NOLOCK)&#xD;&#xA;WHERE       PERSON_ACCOUNT_ID = @PERSON_ACCOUNT_ID AND (TRANSACTION_TYPE_VALUE &lt;&gt; 'PMNT' OR (TRANSACTION_TYPE_VALUE = 'PMNT' AND YEAR(TRANSACTION_DATE) &lt; @COMPUTATIONAL_YEAR - 1)) and EFFECTIVE_DATE &lt;= @RETIREMENT_DATE&#xD;&#xA;   AND COMPUTATIONAL_YEAR &lt; @COMPUTATIONAL_YEAR&#xD;&#xA;&#xD;&#xA;END&#xD;&#xA;ELSE IF @REEMPLOYED = 1&#xD;&#xA;BEGIN&#xD;&#xA;SELECT      MAX(COMPUTATIONAL_YEAR) AS COMPUTATIONAL_YEAR,&#xD;&#xA;            SUM(ISNULL(IAP_BALANCE_AMOUNT,0))IAP_BALANCE_AMOUNT&#xD;&#xA;FROM        SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION WITH(NOLOCK)&#xD;&#xA;WHERE       PERSON_ACCOUNT_ID = @PERSON_ACCOUNT_ID AND (TRANSACTION_TYPE_VALUE &lt;&gt; 'PMNT' OR (TRANSACTION_TYPE_VALUE = 'PMNT' AND YEAR(TRANSACTION_DATE) &lt; @COMPUTATIONAL_YEAR - 1)) and EFFECTIVE_DATE &gt; @RETIREMENT_DATE&#xD;&#xA;   AND COMPUTATIONAL_YEAR &lt; @COMPUTATIONAL_YEAR&#xD;&#xA;   &#xD;&#xA;END&#xD;&#xA;ELSE&#xD;&#xA;BEGIN&#xD;&#xA;SELECT      MAX(COMPUTATIONAL_YEAR) AS COMPUTATIONAL_YEAR,&#xD;&#xA;            SUM(ISNULL(IAP_BALANCE_AMOUNT,0))IAP_BALANCE_AMOUNT&#xD;&#xA;FROM        SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION WITH(NOLOCK)&#xD;&#xA;WHERE       PERSON_ACCOUNT_ID = @PERSON_ACCOUNT_ID AND (TRANSACTION_TYPE_VALUE &lt;&gt; 'PMNT' OR (TRANSACTION_TYPE_VALUE = 'PMNT' AND YEAR(TRANSACTION_DATE) &lt; @COMPUTATIONAL_YEAR - 1))&#xD;&#xA;   AND COMPUTATIONAL_YEAR &lt; @COMPUTATIONAL_YEAR&#xD;&#xA;   &#xD;&#xA;END">
      <parameters>
        <parameter ID="@PERSON_ACCOUNT_ID" sfwDataType="int" />
        <parameter ID="@RETIREMENT_DATE" sfwDataType="DateTime" />
        <parameter ID="@COMPUTATIONAL_YEAR" sfwDataType="int" />
        <parameter ID="@RETIREE" sfwDataType="int" />
        <parameter ID="@REEMPLOYED" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="rptLateIAPBatch" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="&#xD;&#xA;SELECT SP.MPI_PERSON_ID,sp.LAST_NAME + ' ' + sp.FIRST_NAME AS NAME, T.LATE_HOURS,ROUND(T.IAP_PERCENT,2) AS IAP_PERCENT,&#xD;&#xA;SUM(CASE WHEN RC.MODIFIED_BY &lt;&gt; @BatchName THEN ISNULL(IAP_BALANCE_AMOUNT,0) ELSE 0 END) AS PREVIOUS_IAP_BALANCE,&#xD;&#xA;SUM(ISNULL(IAP_BALANCE_AMOUNT,0)) AS AFTER_IAP_BALANCE,&#xD;&#xA;CASE WHEN ABA.PAYEE_ACCOUNT_ID &gt; 0 THEN 'RETR' &#xD;&#xA;  WHEN SP.DATE_OF_DEATH IS NOT NULL THEN  'DCSD'  &#xD;&#xA;  ELSE SPA.STATUS_VALUE END [STATUS] &#xD;&#xA;FROM SGT_PERSON(nolock) SP&#xD;&#xA;INNER JOIN TEMP_TABLE_LATE_IAP_ALLOC_BATCH T ON T.PERSON_ID = SP.PERSON_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT(nolock) SPA ON SP.PERSON_ID = SPA.PERSON_ID AND PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION(nolock) rc on rc.PERSON_ACCOUNT_ID = spa.PERSON_ACCOUNT_ID&#xD;&#xA;LEFT OUTER JOIN &#xD;&#xA;(&#xD;&#xA; SELECT TOP 1 SPA.PERSON_ID,MIN(SPA.PAYEE_ACCOUNT_ID) AS PAYEE_ACCOUNT_ID FROM SGT_PAYEE_ACCOUNT SPA &#xD;&#xA; INNER JOIN SGT_PAYEE_BENEFIT_ACCOUNT SPBA ON SPA.PAYEE_BENEFIT_ACCOUNT_ID = SPBA.PAYEE_BENEFIT_ACCOUNT_ID AND SPBA.FUNDS_TYPE_VALUE IS NULL&#xD;&#xA; INNER JOIN SGT_PLAN_BENEFIT_XR X ON SPA.PLAN_BENEFIT_ID = X.PLAN_BENEFIT_ID AND X.PLAN_ID = 1 &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_STATUS SPAS ON SPAS.PAYEE_ACCOUNT_ID = SPA.PAYEE_ACCOUNT_ID AND &#xD;&#xA; SPAS.PAYEE_ACCOUNT_STATUS_ID = (SELECT TOP 1 Q.PAYEE_ACCOUNT_STATUS_ID FROM SGT_PAYEE_ACCOUNT_STATUS Q WHERE Q.PAYEE_ACCOUNT_ID = SPA.PAYEE_ACCOUNT_ID ORDER BY STATUS_EFFECTIVE_DATE DESC) &#xD;&#xA; WHERE SPAS.STATUS_VALUE &lt;&gt; 'CANC' AND SPA.BENEFIT_ACCOUNT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA; GROUP BY SPA.PERSON_ID&#xD;&#xA; &#xD;&#xA;)ABA ON SP.PERSON_ID = ABA.PERSON_ID &#xD;&#xA;GROUP BY SP.MPI_PERSON_ID,sp.LAST_NAME ,sp.FIRST_NAME,T.LATE_HOURS,T.IAP_PERCENT,ABA.PAYEE_ACCOUNT_ID,SPA.STATUS_VALUE,SP.DATE_OF_DEATH&#xD;&#xA;ORDER BY sp.LAST_NAME&#xD;&#xA;&#xD;&#xA;DROP TABLE TEMP_TABLE_LATE_IAP_ALLOC_BATCH">
      <parameters>
        <parameter ID="@BatchName" sfwDataType="string" />
      </parameters>
    </query>
    <query ID="DeleteSnapshotEntriesForSpecificParticipants" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql=" --Ticket - 60382&#xD;&#xA; IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES &#xD;&#xA;           WHERE TABLE_NAME = N'TEMP_TABLE_FOR_ANNUAL_BATCHES')&#xD;&#xA;BEGIN&#xD;&#xA;DELETE AD FROM SGT_IAP_ALLOCATION_DETAIL AD&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT SPA ON AD.PERSON_ACCOUNT_ID = SPA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN  SGT_PERSON SP ON SP.PERSON_ID = SPA.PERSON_ID&#xD;&#xA;WHERE SP.MPI_PERSON_ID IN (SELECT MPI_PERSON_ID FROM TEMP_TABLE_FOR_ANNUAL_BATCHES)&#xD;&#xA;AND AD.COMPUTATION_YEAR = @COMPUTATION_YEAR&#xD;&#xA;END">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="CreateCopyForSnapshotTable" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql=" --Ticket - 60382&#xD;&#xA;IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES &#xD;&#xA;           WHERE TABLE_NAME = N'SGT_IAP_ALLOCATION_DETAIL_SNAPSHOT_BACKUP')&#xD;&#xA;BEGIN&#xD;&#xA;  DROP TABLE SGT_IAP_ALLOCATION_DETAIL_SNAPSHOT_BACKUP&#xD;&#xA;END&#xD;&#xA;&#xD;&#xA;SELECT * INTO SGT_IAP_ALLOCATION_DETAIL_SNAPSHOT_BACKUP FROM SGT_IAP_ALLOCATION_DETAIL WHERE COMPUTATION_YEAR = @COMPUTATION_YEAR&#xD;&#xA;">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetEffectiveDatefromApplication" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql=" SELECT b.PERSON_ID, b.MPI_PERSON_ID, b.RETIREMENT_DATE,b.WITHDRAWAL_DATE, b.BENEFIT_APPLICATION_ID  FROM (&#xD;&#xA;&#x9;SELECT a.PERSON_ID, a.MPI_PERSON_ID, a.RETIREMENT_DATE,a.WITHDRAWAL_DATE, a.BENEFIT_APPLICATION_ID FROM (&#xD;&#xA;&#x9;&#x9;&#x9;SELECT b.PERSON_ID, b.MPI_PERSON_ID, ba.RETIREMENT_DATE, ba.WITHDRAWAL_DATE, ba.BENEFIT_APPLICATION_ID FROM SGT_PERSON b&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;INNER JOIN SGT_BENEFIT_APPLICATION ba ON b.PERSON_ID = ba.PERSON_ID&#xD;&#xA;&#x9;&#x9;&#x9;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL bad ON ba.BENEFIT_APPLICATION_ID = bad.BENEFIT_APPLICATION_ID &#xD;&#xA;&#x9;&#x9;&#x9;INNER JOIN SGT_PLAN_BENEFIT_XR xr ON bad.PLAN_BENEFIT_ID = xr.PLAN_BENEFIT_ID&#xD;&#xA;&#x9;&#x9;&#x9;WHERE ba.APPLICATION_STATUS_VALUE='APPR' and xr.PLAN_ID=1 &#xD;&#xA;&#x9;&#x9;&#x9;and not exists (SELECT PERSON_ID FROM SGT_BENEFIT_CALCULATION_HEADER BCH&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  INNER JOIN SGT_BENEFIT_CALCULATION_DETAIL BCD ON BCH.BENEFIT_CALCULATION_HEADER_ID = BCD.BENEFIT_CALCULATION_HEADER_ID&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  WHERE BCH.BENEFIT_APPLICATION_ID = ba.BENEFIT_APPLICATION_ID AND BCD.PLAN_ID=1&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  AND bch.PERSON_ID =b.PERSON_ID AND BCH.CALCULATION_TYPE_VALUE = 'FINL')&#xD;&#xA;&#x9;) a&#xD;&#xA;&#xD;&#xA;WHERE not exists (SELECT PERSON_ID FROM SGT_PAYEE_ACCOUNT PA&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN SGT_PLAN_BENEFIT_XR xrr ON PA.PLAN_BENEFIT_ID = xrr.PLAN_BENEFIT_ID&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE  Pa.PERSON_ID = a.PERSON_ID  AND xrr.PLAN_ID=1)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;)b WHERE b.PERSON_ID = @Person_Id">
      <parameters>
        <parameter ID="@Person_Id" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetIAPMDWorked400Hrs" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT P.SSN, P.PERSON_ID, P.MPI_PERSON_ID AS MPID, P.LAST_NAME, P.FIRST_NAME, P.DATE_OF_BIRTH, BA.RETIREMENT_DATE&#xD;&#xA;&#x9;, BA.MIN_DISTRIBUTION_FLAG, BA.MIN_DISTRIBUTION_DATE&#xD;&#xA;&#x9;, BA.BENEFIT_APPLICATION_ID, BA.BENEFIT_TYPE_VALUE, BAD.BENEFIT_SUBTYPE_VALUE &#xD;&#xA;INTO #TMP1&#xD;&#xA;FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_PERSON P ON BA.PERSON_ID = P.PERSON_ID&#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID --AND PB.PLAN_ID= 2&#xD;&#xA;WHERE PB.PLAN_ID= 1 AND YEAR(BA.RETIREMENT_DATE) &lt;= @YEAR --AND BA.MIN_DISTRIBUTION_FLAG = 'Y' AND P.DATE_OF_DEATH IS NULL --AND BA.BENEFIT_TYPE_VALUE NOT IN ('WDRL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' &#xD;&#xA;--21611&#xD;&#xA;--DROP TABLE #HOURSWORKED_400&#xD;&#xA;--SELECT * INTO #HOURSWORKED_400&#xD;&#xA;--FROM (SELECT H.SSN, R.PensionYear, SUM(H.HOURSWORKED) AS HOURS&#xD;&#xA;--&#x9;FROM EADB.DBO.REPORT R INNER JOIN EADB.DBO.HOURS H ON R.REPORTID = H.REPORTID AND H.STATUS = 0&#xD;&#xA;--&#x9;INNER JOIN (SELECT DISTINCT SSN FROM #TMP1) RL ON H.SSN = RL.SSN AND R.PensionYear = @PLAN_YEAR&#xD;&#xA;--&#x9;GROUP BY H.SSN, R.PensionYear ) X WHERE HOURS &gt;= 400&#xD;&#xA; &#xD;&#xA; SELECT * INTO #HOURSWORKED_400&#xD;&#xA;FROM (SELECT T1.SSN, WH.COMPUTATIONYEAR AS PensionYear, SUM(WH.HOURSWORKED) AS HOURS FROM [Pillars].[dbo].[MPI_WorkHistory] WH&#xD;&#xA; INNER JOIN #TMP1 T1 ON WH.MPIPersonId = T1.MPID AND WH.ComputationYear = @YEAR&#xD;&#xA; GROUP BY  T1.SSN, WH.COMPUTATIONYEAR) X WHERE X.HOURS &gt;= 400&#xD;&#xA; &#xD;&#xA;&#xD;&#xA;--608&#xD;&#xA;&#xD;&#xA;--IAP MD-worked 400 or more hours in 2017 &#xD;&#xA;SELECT DISTINCT T.MPID, T.LAST_NAME, T.FIRST_NAME, T.DATE_OF_BIRTH, T.RETIREMENT_DATE AS IAP_MD_APP_RETIREMENT_DATE, HOURS = H.HOURS&#xD;&#xA;&#x9;, IAP_BALANCE = (SELECT SUM(ISNULL(RC.IAP_BALANCE_AMOUNT,0)) FROM SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION RC WHERE RC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID)&#xD;&#xA;--INTO #IAPMD&#xD;&#xA;FROM #TMP1 T INNER JOIN #HOURSWORKED_400 H ON T.SSN = H.SSN AND H.PensionYear = @YEAR AND H.HOURS &gt;= 400 &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT ACCT ON T.PERSON_ID = ACCT.PERSON_ID AND ACCT.PLAN_ID = 1&#xD;&#xA;WHERE H.PENSIONYEAR IS NOT NULL AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') = 'Y' AND T.RETIREMENT_DATE &lt; '01/01/'+''+CONVERT(varchar, @YEAR +1)&#xD;&#xA;--84&#xD;&#xA;AND NOT EXISTS (&#xD;&#xA;SELECT 1 FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID &#xD;&#xA;WHERE BA.PERSON_ID = T.PERSON_ID AND BA.RETIREMENT_DATE &gt; T.RETIREMENT_DATE AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') &lt;&gt; 'Y'&#xD;&#xA;AND PB.PLAN_ID = 1 AND BA.BENEFIT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' )&#xD;&#xA;--84">
      <parameters>
        <parameter ID="@YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetPensionYear" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT distinct [PensionYear] AS PensionYearID,&#xD;&#xA;        CAST(PensionYear AS varchar(4)) AS PensionYear&#xD;&#xA;  FROM [Pillars].[dbo].[PensionYear]">
      <parameters />
    </query>
    <query ID="GetIAPReemployedWorked870Hrs" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT P.SSN, P.PERSON_ID, P.MPI_PERSON_ID AS MPID, P.LAST_NAME, P.FIRST_NAME, P.DATE_OF_BIRTH, BA.RETIREMENT_DATE&#xD;&#xA;&#x9;, BA.MIN_DISTRIBUTION_FLAG, BA.MIN_DISTRIBUTION_DATE&#xD;&#xA;&#x9;, BA.BENEFIT_APPLICATION_ID, BA.BENEFIT_TYPE_VALUE, BAD.BENEFIT_SUBTYPE_VALUE &#xD;&#xA;INTO #TMP1&#xD;&#xA;FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_PERSON P ON BA.PERSON_ID = P.PERSON_ID&#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID --AND PB.PLAN_ID= 2&#xD;&#xA;WHERE PB.PLAN_ID= 1 AND YEAR(BA.RETIREMENT_DATE) &lt;= @YEAR --AND BA.MIN_DISTRIBUTION_FLAG = 'Y' AND P.DATE_OF_DEATH IS NULL --AND BA.BENEFIT_TYPE_VALUE NOT IN ('WDRL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' &#xD;&#xA;--21611&#xD;&#xA;--DROP TABLE #HOURSWORKED_400&#xD;&#xA; SELECT * INTO #HOURSWORKED_400&#xD;&#xA;FROM (SELECT T1.SSN, WH.COMPUTATIONYEAR AS PensionYear, SUM(WH.HOURSWORKED) AS HOURS FROM [Pillars].[dbo].[MPI_WorkHistory] WH&#xD;&#xA; INNER JOIN #TMP1 T1 ON WH.MPIPersonId = T1.MPID AND WH.ComputationYear = @YEAR&#xD;&#xA; GROUP BY  T1.SSN, WH.COMPUTATIONYEAR) X WHERE X.HOURS &gt;= 400&#xD;&#xA;--608&#xD;&#xA;&#xD;&#xA;--IAP MD-worked 400 or more hours in 2017 &#xD;&#xA;SELECT DISTINCT T.MPID, T.LAST_NAME, T.FIRST_NAME, T.DATE_OF_BIRTH, T.RETIREMENT_DATE AS IAP_MD_APP_RETIREMENT_DATE, HOURS2017 = H.HOURS&#xD;&#xA;&#x9;, IAP_BALANCE = (SELECT SUM(ISNULL(RC.IAP_BALANCE_AMOUNT,0)) FROM SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION RC WHERE RC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID)&#xD;&#xA;INTO #IAPMD&#xD;&#xA;FROM #TMP1 T INNER JOIN #HOURSWORKED_400 H ON T.SSN = H.SSN AND H.PensionYear = @YEAR AND H.HOURS &gt;= 400 &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT ACCT ON T.PERSON_ID = ACCT.PERSON_ID AND ACCT.PLAN_ID = 1&#xD;&#xA;WHERE PENSIONYEAR IS NOT NULL AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') = 'Y' AND T.RETIREMENT_DATE &lt; '01/01/'+''+CONVERT(varchar, @YEAR +1)&#xD;&#xA;--84&#xD;&#xA;AND NOT EXISTS (&#xD;&#xA;SELECT 1 FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID &#xD;&#xA;WHERE BA.PERSON_ID = T.PERSON_ID AND BA.RETIREMENT_DATE &gt; T.RETIREMENT_DATE AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') &lt;&gt; 'Y'&#xD;&#xA;AND PB.PLAN_ID = 1 AND BA.BENEFIT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' )&#xD;&#xA;--84&#xD;&#xA;&#xD;&#xA;--IAP RE-worked 870.0 or more hours in 2017&#xD;&#xA;SELECT DISTINCT T.MPID, T.LAST_NAME, T.FIRST_NAME, T.DATE_OF_BIRTH, T.RETIREMENT_DATE AS IAP_RETIREMENT_DATE, HOURS = H.HOURS&#xD;&#xA;&#x9;, IAP_BALANCE = (SELECT SUM(ISNULL(RC.IAP_BALANCE_AMOUNT,0)) FROM SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION RC WHERE RC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID)&#xD;&#xA;FROM #TMP1 T INNER JOIN #HOURSWORKED_400 H ON T.SSN = H.SSN AND H.PensionYear = @YEAR AND H.HOURS &gt;= 870 &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT ACCT ON T.PERSON_ID = ACCT.PERSON_ID AND ACCT.PLAN_ID = 1&#xD;&#xA;WHERE PENSIONYEAR IS NOT NULL AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') &lt;&gt; 'Y' AND T.RETIREMENT_DATE &lt; '01/01/'+''+CONVERT(varchar, @YEAR +1) AND T.BENEFIT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA;AND T.MPID NOT IN (SELECT MPID FROM #IAPMD)&#xD;&#xA;--311&#xD;&#xA;AND NOT EXISTS (&#xD;&#xA;SELECT 1 FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID &#xD;&#xA;WHERE BA.PERSON_ID = T.PERSON_ID AND BA.RETIREMENT_DATE &gt; T.RETIREMENT_DATE AND ISNULL(T.MIN_DISTRIBUTION_FLAG,'N') = 'Y'&#xD;&#xA;AND PB.PLAN_ID = 1 AND BA.BENEFIT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' )&#xD;&#xA;--311&#xD;&#xA;AND EXISTS (&#xD;&#xA;SELECT 1 FROM SGT_BENEFIT_APPLICATION BA &#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL BAD ON BA.BENEFIT_APPLICATION_ID = BAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR PB ON BAD.PLAN_BENEFIT_ID = PB.PLAN_BENEFIT_ID &#xD;&#xA;WHERE BA.PERSON_ID = T.PERSON_ID AND BA.RETIREMENT_DATE &lt; '01/01/'+''+CONVERT(varchar, @YEAR) AND&#xD;&#xA;PB.PLAN_ID = 2 AND BA.BENEFIT_TYPE_VALUE IN ('RTMT','DSBL')&#xD;&#xA;AND BAD.APPLICATION_DETAIL_STATUS_VALUE = 'APPR' AND BA.APPLICATION_STATUS_VALUE = 'APPR' )&#xD;&#xA;AND FLOOR(DATEDIFF(DAY, T.DATE_OF_BIRTH, T.RETIREMENT_DATE) / 365.25) &gt;= 65">
      <parameters>
        <parameter ID="@YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetRetiredInStatementYearRU65Balance" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--GetRetiredInStatementYearRU65Balance &#xD;&#xA;SELECT BALANCE_ELIGIBLE_FOR_ALLOCATION = SUM(ISNULL(SYSTEM_BEGINNING_BALANCE,0) + ISNULL(L52_SPECIAL_ACCOUNT_AMOUNT,0) + ISNULL(L161_SPECIAL_ACCOUNT_AMOUNT,0)&#xD;&#xA;+ ISNULL(FORFEITED_BALANCE,0)&#xD;&#xA;+ isnull(LATE_ALLOC2_AMOUNT,0)+isnull(LATE_ALLOC4_AMOUNT,0)+isnull(LATE_ALLOC1_AMOUNT,0)+isnull(LATE_ALLOC3_AMOUNT,0)+isnull(LATE_ALLOC5_AMOUNT,0)&#xD;&#xA;+ ISNULL(QUATERLY_ALLOCATIONS_AMOUNT,0)+ISNULL(RETIREMENT_YEAR_ALLOCATION2_AMOUNT,0)+ISNULL(RETIREMENT_YEAR_ALLOCATION4_AMOUNT,0)+ISNULL(PAYOUTS,0)+ISNULL(UNALLOCABLE_AMOUNT,0) )&#xD;&#xA;FROM SGT_IAP_ALLOCATION_DETAIL ID INNER JOIN SGT_PERSON_ACCOUNT PA ON ID.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID INNER JOIN SGT_PERSON P ON PA.PERSON_ID = P.PERSON_ID &#xD;&#xA;INNER JOIN (&#xD;&#xA;SELECT PERSON_ACCOUNT_ID, MAX(SBA.RETIREMENT_DATE) AS RETIREMENT_DATE &#xD;&#xA;FROM SGT_BENEFIT_APPLICATION SBA&#xD;&#xA;INNER JOIN SGT_PERSON SP ON SBA.PERSON_ID = SP.PERSON_ID AND APPLICATION_STATUS_VALUE = 'APPR'&#xD;&#xA;INNER JOIN SGT_BENEFIT_APPLICATION_DETAIL SBAD ON SBA.BENEFIT_APPLICATION_ID = SBAD.BENEFIT_APPLICATION_ID&#xD;&#xA;INNER JOIN SGT_PLAN_BENEFIT_XR X ON SBAD.PLAN_BENEFIT_ID = X.PLAN_BENEFIT_ID AND X.PLAN_ID = 1&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA ON SBA.PERSON_ID = PA.PERSON_ID AND PA.PLAN_ID = 1&#xD;&#xA;GROUP BY PERSON_ACCOUNT_ID&#xD;&#xA;) RD ON ID.PERSON_ACCOUNT_ID = RD.PERSON_ACCOUNT_ID AND ID.COMPUTATION_YEAR = YEAR(RD.RETIREMENT_DATE)&#xD;&#xA;WHERE COMPUTATION_YEAR = @COMPUTATION_YEAR AND YEAR(RD.RETIREMENT_DATE) = @COMPUTATION_YEAR&#xD;&#xA;AND FUND_TYPE = 'IAP' AND IAP_ALLOCATION_CATEGORY_VALUE = 'RU65'">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="GetIAPPaybackSummary" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--GetIAPPaybackSummary&#xD;&#xA;DECLARE @START_DATE DATETIME = CAST(CAST(@COMPUTATION_YEAR AS VARCHAR(4))+'0101' AS DATETIME)&#xD;&#xA;DECLARE @END_DATE DATETIME = CAST(CAST(@COMPUTATION_YEAR AS VARCHAR(4))+'1231' AS DATETIME)&#xD;&#xA;&#xD;&#xA;SELECT ISNULL(SUM(PHH.CHECK_AMOUNT),0) PAYBACK&#xD;&#xA;FROM SGT_IAP_HARDSHIP_PAYBACK PHH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PAYEE_ACCOUNT SPA ON SPA.PAYEE_ACCOUNT_ID = PHH.PAYEE_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PAYEE_BENEFIT_ACCOUNT SPBA ON SPBA.PAYEE_BENEFIT_ACCOUNT_ID = SPA.PAYEE_BENEFIT_ACCOUNT_ID&#xD;&#xA;LEFT OUTER JOIN SGT_PERSON_ACCOUNT PA ON PA.PERSON_ACCOUNT_ID = SPBA.PERSON_ACCOUNT_ID AND PA.PLAN_ID = 1&#xD;&#xA;WHERE CONVERT(DATE,PAYMENT_POSTED_DATE) BETWEEN @START_DATE AND @END_DATE">
      <parameters>
        <parameter ID="@COMPUTATION_YEAR" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute sfwValue="iap_allocation_detail_id" sfwType="Column" sfwKeyNo="1" sfwIsIdentity="True" sfwDataType="int" sfwDBDataType="int" sfwIsNull="False" ID="IapAllocationDetailId" sfwIsSequence="False" sfwCaption="ID" />
    <attribute sfwValue="person_account_id" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="int" sfwDBDataType="int" sfwIsNull="False" ID="PersonAccountId" sfwIsSequence="False" sfwCaption="Person Account Id" />
    <attribute sfwValue="computation_year" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="int" sfwDBDataType="int" sfwIsNull="False" ID="ComputationYear" sfwIsSequence="False" sfwCaption="Computation Year" />
    <attribute sfwValue="system_beginning_balance" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="SystemBeginningBalance" sfwIsSequence="False" sfwCaption="System Beginning Balance" />
    <attribute sfwValue="forfeited_balance" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="ForfeitedBalance" sfwIsSequence="False" sfwCaption="Forfeited Balance" />
    <attribute sfwValue="quaterly_allocations_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="QuaterlyAllocationsAmount" sfwIsSequence="False" sfwCaption="Quaterly Allocations Amount" />
    <attribute sfwValue="retirement_year_allocation2_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="RetirementYearAllocation2Amount" sfwIsSequence="False" sfwCaption="Retirement Year Allocation2 Amount" />
    <attribute sfwValue="retirement_year_allocation4_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="RetirementYearAllocation4Amount" sfwIsSequence="False" sfwCaption="Retirement Year Allocation4 Amount" />
    <attribute sfwValue="payouts" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Payouts" sfwIsSequence="False" sfwCaption="Payouts" />
    <attribute sfwValue="unallocable_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="UnallocableAmount" sfwIsSequence="False" sfwCaption="Unallocable Amount" />
    <attribute sfwValue="late_ineligible_hours" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="18,1" sfwIsNull="True" ID="LateIneligibleHours" sfwIsSequence="False" sfwCaption="Late Ineligible Hours" />
    <attribute sfwValue="late_ineligible_hourly_contribution_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateIneligibleHourlyContributionAmount" sfwIsSequence="False" sfwCaption="Late Ineligible Hourly Contribution Amount" />
    <attribute sfwValue="current_year_ineligible_hours" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="18,1" sfwIsNull="True" ID="CurrentYearIneligibleHours" sfwIsSequence="False" sfwCaption="Current Year Ineligible Hours" />
    <attribute sfwValue="current_year_ineligible_contribution_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="CurrentYearIneligibleContributionAmount" sfwIsSequence="False" sfwCaption="Current Year Ineligible Contribution Amount" />
    <attribute sfwValue="eligible_hours" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="18,1" sfwIsNull="True" ID="EligibleHours" sfwIsSequence="False" sfwCaption="Eligible Hours" />
    <attribute sfwValue="hourly_contribution_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="HourlyContributionAmount" sfwIsSequence="False" sfwCaption="Hourly Contribution Amount" />
    <attribute sfwValue="late_inelgibile_compensation_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateInelgibileCompensationAmount" sfwIsSequence="False" sfwCaption="Late Inelgibile Compensation Amount" />
    <attribute sfwValue="current_year_inelgibile_compensation_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="CurrentYearInelgibileCompensationAmount" sfwIsSequence="False" sfwCaption="Current Year Inelgibile Compensation Amount" />
    <attribute sfwValue="overlimit_contributions_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="OverlimitContributionsAmount" sfwIsSequence="False" sfwCaption="Overlimit Contributions Amount" />
    <attribute sfwValue="percentage_of_compensation_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="PercentageOfCompensationAmount" sfwIsSequence="False" sfwCaption="Percentage Of Compensation Amount" />
    <attribute sfwType="Description" ID="IapAllocationCategoryDescription" sfwCaption="Iap Allocation Category" sfwValue="iap_allocation_category_description" />
    <attribute sfwValue="iap_allocation_category_id" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="int" sfwDBDataType="int" sfwIsNull="False" ID="IapAllocationCategoryId" sfwCodeID="1002" sfwIsSequence="False" sfwCaption="Iap Allocation Category" />
    <attribute sfwValue="iap_allocation_category_value" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwDBDataType="varchar" sfwLength="4" sfwIsNull="True" ID="IapAllocationCategoryValue" sfwIsSequence="False" sfwCaption="Iap Allocation Category" />
    <attribute sfwValue="created_by" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwDBDataType="varchar" sfwLength="50" sfwIsNull="False" ID="CreatedBy" sfwIsSequence="False" sfwCaption="Created By" />
    <attribute sfwValue="created_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="False" ID="CreatedDate" sfwIsSequence="False" sfwCaption="Created Date" />
    <attribute sfwValue="modified_by" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwDBDataType="varchar" sfwLength="50" sfwIsNull="False" ID="ModifiedBy" sfwIsSequence="False" sfwCaption="Modified By" />
    <attribute sfwValue="modified_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="False" ID="ModifiedDate" sfwIsSequence="False" sfwCaption="Modified Date" />
    <attribute sfwValue="update_seq" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="int" sfwDBDataType="int" sfwIsNull="False" ID="UpdateSeq" sfwIsSequence="False" sfwCaption="Update Seq" />
    <attribute sfwValue="total_ineligible_iap_late_hours" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="TotalIneligibleIapLateHours" sfwIsSequence="False" sfwCaption="Total Ineligible Iap Late Hours" />
    <attribute sfwValue="total_iap_hours" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="TotalIapHours" sfwIsSequence="False" sfwCaption="Total Iap Hours" />
    <attribute sfwValue="l52_special_account_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="L52SpecialAccountAmount" sfwIsSequence="False" sfwCaption="L52 Special Account Amount" />
    <attribute sfwValue="l161_special_account_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="L161SpecialAccountAmount" sfwIsSequence="False" sfwCaption="L161 Special Account Amount" />
    <attribute sfwValue="allocation1_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation1Amount" sfwIsSequence="False" sfwCaption="Allocation1 Amount" />
    <attribute sfwValue="l52_allocation1_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="L52Allocation1Amount" sfwIsSequence="False" sfwCaption="L52 Allocation1 Amount" />
    <attribute sfwValue="l161_allocation1_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="L161Allocation1Amount" sfwIsSequence="False" sfwCaption="L161 Allocation1 Amount" />
    <attribute sfwValue="allocation2_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation2Amount" sfwIsSequence="False" sfwCaption="Allocation2 Amount" />
    <attribute sfwValue="allocation2_invst_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation2InvstAmount" sfwIsSequence="False" sfwCaption="Allocation2 Invst Amount" />
    <attribute sfwValue="allocation2_frft_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation2FrftAmount" sfwIsSequence="False" sfwCaption="Allocation2 Frft Amount" />
    <attribute sfwValue="allocation4_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation4Amount" sfwIsSequence="False" sfwCaption="Allocation4 Amount" />
    <attribute sfwValue="allocation4_invst_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation4InvstAmount" sfwIsSequence="False" sfwCaption="Allocation4 Invst Amount" />
    <attribute sfwValue="allocation4_frft_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="Allocation4FrftAmount" sfwIsSequence="False" sfwCaption="Allocation4 Frft Amount" />
    <attribute sfwValue="late_alloc2_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateAlloc2Amount" sfwIsSequence="False" sfwCaption="Late Alloc2 Amount" />
    <attribute sfwValue="late_alloc4_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateAlloc4Amount" sfwIsSequence="False" sfwCaption="Late Alloc4 Amount" />
    <attribute sfwValue="late_alloc1_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateAlloc1Amount" sfwIsSequence="False" sfwCaption="Late Alloc1 Amount" />
    <attribute sfwValue="late_alloc3_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateAlloc3Amount" sfwIsSequence="False" sfwCaption="Late Alloc3 Amount" />
    <attribute sfwValue="late_alloc5_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateAlloc5Amount" sfwIsSequence="False" sfwCaption="Late Alloc5 Amount" />
    <attribute sfwValue="fund_type" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwDBDataType="varchar" sfwLength="4" sfwIsNull="True" ID="FundType" sfwCaption="Fund Type" />
    <attribute sfwValue="late_hourly_contribution" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateHourlyContribution" sfwCaption="Late Hourly Contribution" />
    <attribute sfwValue="late_salary_compensation" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateSalaryCompensation" sfwCaption="Late Salary Compensation" />
    <attribute sfwValue="current_yr_beginning_balance" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="CurrentYrBeginningBalance" sfwCaption="Current Yr Beginning Balance" />
    <attribute sfwValue="ending_balance" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="EndingBalance" sfwCaption="Ending Balance" />
    <attribute sfwValue="beginning_bal_adjustment" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="BeginningBalAdjustment" sfwCaption="Beginning Bal Adjustment" />
    <attribute sfwValue="late_eligible_hourly_contribution_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateEligibleHourlyContributionAmount" sfwCaption="Late Eligible Hourly Contribution Amount" />
    <attribute sfwValue="late_eligible_compensation_amount" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="LateEligibleCompensationAmount" sfwCaption="Late Eligible Compensation Amount" />
    <attribute sfwValue="birth_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="BirthDate" sfwCaption="Birth Date" />
    <attribute sfwValue="md_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="MdDate" sfwCaption="Md Date" />
    <attribute sfwValue="retire_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="RetireDate" sfwCaption="Retire Date" />
    <attribute sfwValue="ss_award_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="SsAwardDate" sfwCaption="Ss Award Date" />
    <attribute sfwValue="deceased_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="DeceasedDate" sfwCaption="Deceased Date" />
    <attribute sfwValue="withdrawal_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="WithdrawalDate" sfwCaption="Withdrawal Date" />
    <attribute sfwValue="first_pmt_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="FirstPmtDate" sfwCaption="First Pmt Date" />
    <attribute sfwValue="qdro_commence_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="QdroCommenceDate" sfwCaption="Qdro Commence Date" />
    <attribute sfwValue="determination_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="datetime" sfwDBDataType="datetime" sfwIsNull="True" ID="DeterminationDate" sfwCaption="Determination Date" />
    <attribute sfwValue="prev_yr_ending_bal" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="PrevYrEndingBal" sfwCaption="Prev Yr Ending Bal" />
    <attribute sfwValue="eligible_quarter" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="18,1" sfwIsNull="True" ID="EligibleQuarter" sfwCaption="Eligible Quarter" />
    <attribute sfwValue="quarterly_factor" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="18,1" sfwIsNull="True" ID="QuarterlyFactor" sfwCaption="Quarterly Factor" />
    <attribute sfwValue="alloctype_code" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwDBDataType="varchar" sfwLength="10" sfwIsNull="True" ID="AlloctypeCode" sfwCaption="Alloctype Code" />
    <attribute sfwValue="allocable_beg_bal" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="AllocableBegBal" sfwCaption="Allocable Beg Bal" />
    <attribute sfwValue="allocable_ending_balance" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="AllocableEndingBalance" sfwCaption="Allocable Ending Balance" />
    <attribute sfwValue="hrs_before_det_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="HrsBeforeDetDate" sfwCaption="Hrs Before Det Date" />
    <attribute sfwValue="hrs_after_det_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="HrsAfterDetDate" sfwCaption="Hrs After Det Date" />
    <attribute sfwValue="hrs_a2_before_det_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="HrsA2BeforeDetDate" sfwCaption="Hrs A2 Before Det Date" />
    <attribute sfwValue="hrs_a2_after_det_date" sfwType="Column" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="decimal" sfwDBDataType="numeric" sfwLength="11,2" sfwIsNull="True" ID="HrsA2AfterDetDate" sfwCaption="Hrs A2 After Det Date" />
  </attributes>
  <constraint />
  <rules />
  <initialload />
  <softerror />
  <harderror />
  <validatedelete />
  <delete />
  <groupslist />
  <checklist />
  <methods />
  <lifecycle />
  <objectmethods />
  <ExtraFields />
</entity>