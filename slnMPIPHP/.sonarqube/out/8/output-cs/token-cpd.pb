ƒ
VC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str (
)( )
]) *
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8á
OC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\ProjectInstaller.cs
	namespace 	
NeoBPMN
 
. 
Service 
{ 
[ 
RunInstaller 
( 
true 
) 
] 
public 

partial 
class 
ProjectInstaller )
:* +
System, 2
.2 3
Configuration3 @
.@ A
InstallA H
.H I
	InstallerI R
{		 
public

 
ProjectInstaller

 
(

  
)

  !
{ 	
InitializeComponent 
(  
)  !
;! "#
ServiceProcessInstaller ##
serviceProcessInstaller$ ;
=< =
new> A#
ServiceProcessInstallerB Y
(Y Z
)Z [
;[ \
ServiceInstaller 
serviceInstaller -
=. /
new0 3
ServiceInstaller4 D
(D E
)E F
;F G#
serviceProcessInstaller #
.# $
Account$ +
=, -
ServiceAccount. <
.< =
LocalSystem= H
;H I#
serviceProcessInstaller #
.# $
Username$ ,
=- .
null/ 3
;3 4#
serviceProcessInstaller #
.# $
Password$ ,
=- .
null/ 3
;3 4
serviceInstaller 
. 
ServiceName (
=) *
$str+ ?
;? @
serviceInstaller 
. 
DisplayName (
=) *
$str+ G
;G H
serviceInstaller 
. 
Description (
=) *
$str+ C
;C D
serviceInstaller 
. 
	StartType &
=' (
ServiceStartMode) 9
.9 :
	Automatic: C
;C D
this 
. 

Installers 
. 
Add 
(  #
serviceProcessInstaller  7
)7 8
;8 9
this 
. 

Installers 
. 
Add 
(  
serviceInstaller  0
)0 1
;1 2
} 	
	protected!! 
override!! 
void!! 
OnBeforeInstall!!  /
(!!/ 0
IDictionary!!0 ;

savedState!!< F
)!!F G
{"" 	
base## 
.## 
OnBeforeInstall##  
(##  !

savedState##! +
)##+ ,
;##, -
}'' 	
	protected-- 
override-- 
void-- 
OnBeforeUninstall--  1
(--1 2
IDictionary--2 =

savedState--> H
)--H I
{.. 	
base// 
.// 
OnBeforeUninstall// "
(//" #

savedState//# -
)//- .
;//. /
}33 	
}44 
}55 è
FC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\Program.cs
	namespace		 	
NeoBPMN		
 
.		 
Service		 
{

 
static 

class 
Program 
{ 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
MPIPHP 
. 
Common 
. 
ApplicationSettings -
.- .
MapSettingsObject. ?
(? @
)@ A
;A B&
NeoBaseApplicationSettings &
.& '
MapSettingsObject' 8
(8 9
)9 :
;: ;
string 
	lstrParam 
=  
ConfigurationManager 3
.3 4
AppSettings4 ?
[? @
$str@ R
]R S
.S T
ToStringT \
(\ ]
)] ^
;^ _
bool 
blnConsoleMode 
=  !
false" '
;' (
if 
( 
	lstrParam 
!= 
null !
&&" $
	lstrParam% .
.. /
Length/ 5
>6 7
$num8 9
)9 :
{ 
if 
( 
	lstrParam 
==  
$str! '
)' (
blnConsoleMode "
=# $
false% *
;* +
else 
blnConsoleMode "
=# $
true% )
;) *
} 
if   
(   
blnConsoleMode   
)   
{!! 
Application"" 
."" 
EnableVisualStyles"" .
("". /
)""/ 0
;""0 1
Application## 
.## -
!SetCompatibleTextRenderingDefault## =
(##= >
false##> C
)##C D
;##D E
Application$$ 
.$$ 
Run$$ 
($$  
new$$  #
frmBPMNService$$$ 2
($$2 3
args$$3 7
)$$7 8
)$$8 9
;$$9 :
}%% 
else&& 
{'' 
ServiceBase(( 
[(( 
](( 
ServicesToRun(( +
;((+ ,
ServicesToRun)) 
=)) 
new))  #
ServiceBase))$ /
[))/ 0
]))0 1
{** 
new++ 
NeoSpinService++ +
(+++ ,
args++, 0
)++0 1
},, 
;,, 
ServiceBase-- 
.-- 
Run-- 
(--  
ServicesToRun--  -
)--- .
;--. /
}.. 
}00 	
}11 
}22 ¯.
MC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\NeoSpinService.cs
	namespace 	
NeoBPMN
 
. 
Service 
{ 
public 

partial 
class 
NeoSpinService '
:( )
ServiceBase* 5
{		 
private 
NeoSpinServer 
iNeoSpinServer ,
;, -
public 
NeoSpinService 
( 
string $
[$ %
]% &
args' +
)+ ,
{ 	
InitializeComponent 
(  
)  !
;! "
iNeoSpinServer!! 
=!! 
new!!  
NeoSpinServer!!! .
(!!. /
args!!/ 3
)!!3 4
;!!4 5
this$$ 
.$$ 
EventLog$$ 
.$$ 
Source$$  
=$$! "
$str$$# 4
;$$4 5
this%% 
.%% 
EventLog%% 
.%% 
Log%% 
=%% 
$str%%  -
;%%- .
if'' 
('' 
!'' 
EventLog'' 
.'' 
SourceExists'' &
(''& '
this''' +
.''+ ,
EventLog'', 4
.''4 5
Source''5 ;
)''; <
)''< =
EventLog(( 
.(( 
CreateEventSource(( *
(((* +
this((+ /
.((/ 0
EventLog((0 8
.((8 9
Source((9 ?
,((? @
this((A E
.((E F
EventLog((F N
.((N O
Log((O R
)((R S
;((S T
})) 	
	protected00 
override00 
void00 
OnStart00  '
(00' (
string00( .
[00. /
]00/ 0
args001 5
)005 6
{11 	
this22 
.22 !
RequestAdditionalTime22 &
(22& '
$num22' ,
)22, -
;22- .
base33 
.33 
OnStart33 
(33 
args33 
)33 
;33 
iNeoSpinServer88 
.88 
Start88  
(88  !
)88! "
;88" #
}99 	
	protected?? 
override?? 
void?? 
OnStop??  &
(??& '
)??' (
{@@ 	
iNeoSpinServerAA 
.AA 
StopAA 
(AA  
)AA  !
;AA! "
baseCC 
.CC 
OnStopCC 
(CC 
)CC 
;CC 
}DD 	
	protectedJJ 
overrideJJ 
voidJJ 
OnPauseJJ  '
(JJ' (
)JJ( )
{KK 	
iNeoSpinServerLL 
.LL 
StopLL 
(LL  
)LL  !
;LL! "
baseNN 
.NN 
OnPauseNN 
(NN 
)NN 
;NN 
}OO 	
	protectedUU 
overrideUU 
voidUU 

OnContinueUU  *
(UU* +
)UU+ ,
{VV 	
iNeoSpinServerWW 
.WW 
StartWW  
(WW  !
)WW! "
;WW" #
baseYY 
.YY 

OnContinueYY 
(YY 
)YY 
;YY 
}ZZ 	
	protectedbb 
overridebb 
voidbb 

OnShutdownbb  *
(bb* +
)bb+ ,
{cc 	
iNeoSpinServerdd 
.dd 
Stopdd 
(dd  
)dd  !
;dd! "
baseff 
.ff 

OnShutdownff 
(ff 
)ff 
;ff 
}gg 	
	protectedoo 
overrideoo 
voidoo 
OnCustomCommandoo  /
(oo/ 0
intoo0 3
commandoo4 ;
)oo; <
{pp 	
baseuu 
.uu 
OnCustomCommanduu  
(uu  !
commanduu! (
)uu( )
;uu) *
}vv 	
	protected
‰‰ 
override
‰‰ 
bool
‰‰ 
OnPowerEvent
‰‰  ,
(
‰‰, -"
PowerBroadcastStatus
‰‰- A
powerStatus
‰‰B M
)
‰‰M N
{
ŠŠ 	
switch
‹‹ 
(
‹‹ 
powerStatus
‹‹ 
)
‹‹  
{
ŒŒ 
case
 "
PowerBroadcastStatus
 )
.
) *
QuerySuspend
* 6
:
6 7
return
 
true
 
;
  
case
’’ "
PowerBroadcastStatus
’’ )
.
’’) *
Suspend
’’* 1
:
’’1 2
iNeoSpinServer
”” "
.
””" #
Stop
””# '
(
””' (
)
””( )
;
””) *
break
•• 
;
•• 
case
—— "
PowerBroadcastStatus
—— )
.
——) *
ResumeAutomatic
——* 9
:
——9 :
case
˜˜ "
PowerBroadcastStatus
˜˜ )
.
˜˜) *
ResumeCritical
˜˜* 8
:
˜˜8 9
case
™™ "
PowerBroadcastStatus
™™ )
.
™™) *
ResumeSuspend
™™* 7
:
™™7 8
iNeoSpinServer
›› "
.
››" #
Start
››# (
(
››( )
)
››) *
;
››* +
break
œœ 
;
œœ 
default
 
:
 
break
ŸŸ 
;
ŸŸ 
}
   
base
££ 
.
££ 
OnPowerEvent
££ 
(
££ 
powerStatus
££ )
)
££) *
;
££* +
return
¥¥ 
true
¥¥ 
;
¥¥ 
}
¦¦ 	
	protected
®® 
override
®® 
void
®® 
OnSessionChange
®®  /
(
®®/ 0&
SessionChangeDescription
®®0 H
changeDescription
®®I Z
)
®®Z [
{
¯¯ 	
base
°° 
.
°° 
OnSessionChange
°°  
(
°°  !
changeDescription
°°! 2
)
°°2 3
;
°°3 4
}
±± 	
}
³³ 
}´´ Â›
LC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\NeoSpinServer.cs
	namespace 	
NeoBPMN
 
. 
Service 
{ 
public 

class 
NeoSpinServer 
{   
private## 
busMQRequestHandler## #
iobjRequestHandler##$ 6
=##7 8
null##9 =
;##= >
private(( 
enum(( 
NeoSpinServerState(( '
{)) 	
Stopped++ 
,++ 
Starting.. 
,.. 
Running11 
,11 
Stopping44 
,44 
}55 	
;55	 

private;; 
const;; 
int;;  
SYSRESPONSE_INTERVAL;; .
=;;/ 0
$num;;1 6
;;;6 7
private@@ 
volatile@@ 
NeoSpinServerState@@ +
iServerState@@, 8
;@@8 9
privateEE 
readonlyEE 
objectEE 
iStartStopLockEE  .
=EE/ 0
newEE1 4
objectEE5 ;
(EE; <
)EE< =
;EE= >
privateGG 
stringGG 
[GG 
]GG 
	argumentsGG "
;GG" #
publicSS 
NeoSpinServerSS 
(SS 
stringSS #
[SS# $
]SS$ %
argsSS& *
)SS* +
{TT 	
thisUU 
.UU 
	argumentsUU 
=UU 
argsUU !
;UU! "
thisVV 
.VV 
iServerStateVV 
=VV 
NeoSpinServerStateVV  2
.VV2 3
StoppedVV3 :
;VV: ;
	AppDomainZZ 
.ZZ 
CurrentDomainZZ #
.ZZ# $
UnhandledExceptionZZ$ 6
+=ZZ7 9
newZZ: =*
UnhandledExceptionEventHandlerZZ> \
(ZZ\ ]-
!AppUnhandledExceptionEventHandlerZZ] ~
)ZZ~ 
;	ZZ €
}[[ 	
privateuu 
voiduu -
!AppUnhandledExceptionEventHandleruu 6
(uu6 7
objectuu7 =
senderuu> D
,uuD E'
UnhandledExceptionEventArgsuuF a
eauub d
)uud e
{vv 	
Threadww 
.ww 
CurrentThreadww  
.ww  !
Priorityww! )
=ww* +
ThreadPriorityww, :
.ww: ;
Highestww; B
;wwB C
	Exceptionxx 
exxx 
=xx 
eaxx 
.xx 
ExceptionObjectxx -
asxx. 0
	Exceptionxx1 :
;xx: ;
string}} 

strMessage}} 
=}} 
$str}}  E
+}}F G
iServerState}}H T
;}}T U
if~~ 
(~~ 
ex~~ 
!=~~ 
null~~ 
)~~ 
{ 
}
 
else
‚‚ 
{
ƒƒ 
}
…… 
EventLog
ˆˆ 
.
ˆˆ 

WriteEntry
ˆˆ 
(
ˆˆ  
$str
ˆˆ  1
,
ˆˆ1 2

strMessage
ˆˆ3 =
,
ˆˆ= >
EventLogEntryType
ˆˆ? P
.
ˆˆP Q
Error
ˆˆQ V
)
ˆˆV W
;
ˆˆW X
Stop
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
Environment
 
.
 
Exit
 
(
 
$num
 
)
 
;
  
}
 	
private
–– 
void
–– 
StartServers
–– !
(
––! "
)
––" #
{
—— 	
string
™™ !
strAssemblyLocation
™™ &
=
™™' (
Path
™™) -
.
™™- .
GetDirectoryName
™™. >
(
™™> ?
Assembly
™™? G
.
™™G H"
GetExecutingAssembly
™™H \
(
™™\ ]
)
™™] ^
.
™™^ _
Location
™™_ g
)
™™g h
;
™™h i
HelperFunction
šš 
.
šš %
istrAppSettingsLocation
šš 2
=
šš3 4
Path
šš5 9
.
šš9 :
Combine
šš: A
(
ššA B!
strAssemblyLocation
ššB U
,
ššU V
$str
ššW h
)
ššh i
;
šši j
srvMetaDataCache
œœ 
.
œœ 
LoadXMLCache
œœ )
(
œœ) *
)
œœ* +
;
œœ+ ,
bool
 
lblnSuccess
 
=
 
Sagitec
 &
.
& '
DBCache
' .
.
. /

srvDBCache
/ 9
.
9 :
LoadCacheInfo
: G
(
G H
)
H I
;
I J
CompileRules
ŸŸ 
(
ŸŸ 
)
ŸŸ 
;
ŸŸ 
CorBookmarkHelper
   
.
   '
CacheTemplateStdBookmarks
   7
(
  7 8
)
  8 9
;
  9 :#
InitializeClassMapper
¡¡ !
(
¡¡! "
)
¡¡" #
;
¡¡# $#
utlCacheRefreshHelper
¦¦ !
.
¦¦! ",
StartThreadToRefreshDBSettings
¦¦" @
(
¦¦@ A
)
¦¦A B
;
¦¦B C 
iobjRequestHandler
§§ 
=
§§  
new
§§! $!
busMQRequestHandler
§§% 8
(
§§8 9
utlConstants
§§9 E
.
§§E F
SystemQueue
§§F Q
)
§§Q R
;
§§R S 
iobjRequestHandler
¨¨ 
.
¨¨ 
StartProcessing
¨¨ .
(
¨¨. /
)
¨¨/ 0
;
¨¨0 1 
ExtendedBPMService
ªª 
.
ªª 

Initialize
ªª )
(
ªª) *
	arguments
ªª* 3
)
ªª3 4
;
ªª4 5 
ExtendedBPMService
«« 
.
«« 
Instance
«« '
?
««' (
.
««( )
Start
««) .
(
««. /
)
««/ 0
;
««0 1
}
¬¬ 	
private
±± 
void
±± 
StopServers
±±  
(
±±  !
)
±±! "
{
²² 	
if
³³ 
(
³³  
iobjRequestHandler
³³ "
!=
³³# %
null
³³& *
)
³³* + 
iobjRequestHandler
´´ "
.
´´" #
StopProcessing
´´# 1
(
´´1 2
)
´´2 3
;
´´3 4
if
·· 
(
·· 
Sagitec
·· 
.
·· 
DBCache
·· 
.
··  

srvDBCache
··  *
.
··* +
idctDBCache
··+ 6
!=
··7 9
null
··: >
)
··> ?
Sagitec
¸¸ 
.
¸¸ 
DBCache
¸¸ 
.
¸¸  

srvDBCache
¸¸  *
.
¸¸* +
idctDBCache
¸¸+ 6
.
¸¸6 7
Clear
¸¸7 <
(
¸¸< =
)
¸¸= >
;
¸¸> ?
foreach
»» 
(
»» 
IChannel
»» 

objChannel
»» (
in
»») +
ChannelServices
»», ;
.
»»; < 
RegisteredChannels
»»< N
)
»»N O
ChannelServices
¼¼ 
.
¼¼  
UnregisterChannel
¼¼  1
(
¼¼1 2

objChannel
¼¼2 <
)
¼¼< =
;
¼¼= > 
ExtendedBPMService
¾¾ 
.
¾¾ 
Instance
¾¾ '
?
¾¾' (
.
¾¾( )
Stop
¾¾) -
(
¾¾- .
)
¾¾. /
;
¾¾/ 0
}
¿¿ 	
private
ÄÄ 
void
ÄÄ 

DoSomeWork
ÄÄ 
(
ÄÄ  
)
ÄÄ  !
{
ÅÅ 	
StartServers
ËË 
(
ËË 
)
ËË 
;
ËË 
}
ÌÌ 	
private
ÒÒ 
void
ÒÒ 
StopDoingWork
ÒÒ "
(
ÒÒ" #
)
ÒÒ# $
{
ÓÓ 	
StopServers
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
private
êê 
void
êê 
StartLogging
êê !
(
êê! "
)
êê" #
{
ëë 	
}
íí 	
private
öö 
void
öö 
Startup
öö 
(
öö 
)
öö 
{
÷÷ 	
if
ùù 
(
ùù 
this
ùù 
.
ùù 
iServerState
ùù !
!=
ùù" $ 
NeoSpinServerState
ùù% 7
.
ùù7 8
Starting
ùù8 @
)
ùù@ A
return
úú 
;
úú 
try
üü 
{
ıı 
StartLogging
ÿÿ 
(
ÿÿ 
)
ÿÿ 
;
ÿÿ 
this
 
.
 
iServerState
 !
=
" # 
NeoSpinServerState
$ 6
.
6 7
Running
7 >
;
> ?

DoSomeWork
„„ 
(
„„ 
)
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
EventLog
ˆˆ 
.
ˆˆ 

WriteEntry
ˆˆ #
(
ˆˆ# $
$str
ˆˆ$ 5
,
ˆˆ5 6
$str
ˆˆ7 Y
+
ˆˆZ [
ex
ˆˆ\ ^
.
ˆˆ^ _
Message
ˆˆ_ f
,
ˆˆf g
EventLogEntryType
ˆˆh y
.
ˆˆy z
Error
ˆˆz 
)ˆˆ €
;ˆˆ€ 
throw
ŠŠ 
;
ŠŠ 
}
‹‹ 
}
ŒŒ 	
private
‘‘ 
void
‘‘ 
Shutdown
‘‘ 
(
‘‘ 
)
‘‘ 
{
’’ 	
if
”” 
(
”” 
this
”” 
.
”” 
iServerState
”” !
!=
””" $ 
NeoSpinServerState
””% 7
.
””7 8
Stopping
””8 @
)
””@ A
return
•• 
;
•• 
try
—— 
{
˜˜ 
StopDoingWork
™™ 
(
™™ 
)
™™ 
;
™™  
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
EventLog
 
.
 

WriteEntry
 #
(
# $
$str
$ 5
,
5 6
$str
7 Y
+
Z [
ex
\ ^
.
^ _
Message
_ f
,
f g
EventLogEntryType
h y
.
y z
Error
z 
) €
;€ 
}
 
finally
ŸŸ 
{
   
this
¡¡ 
.
¡¡ 
iServerState
¡¡ !
=
¡¡" # 
NeoSpinServerState
¡¡$ 6
.
¡¡6 7
Stopped
¡¡7 >
;
¡¡> ?
}
¢¢ 
}
££ 	
public
«« 
void
«« 
Start
«« 
(
«« 
)
«« 
{
¬¬ 	
if
­­ 
(
­­ 
this
­­ 
.
­­ 
iServerState
­­ !
==
­­" $ 
NeoSpinServerState
­­% 7
.
­­7 8
Stopped
­­8 ?
)
­­? @
{
®® 
this
¯¯ 
.
¯¯ 
iServerState
¯¯ !
=
¯¯" # 
NeoSpinServerState
¯¯$ 6
.
¯¯6 7
Starting
¯¯7 ?
;
¯¯? @
lock
±± 
(
±± 
this
±± 
.
±± 
iStartStopLock
±± )
)
±±) *
{
²² 
Thread
¶¶ 
startup
¶¶ "
=
¶¶# $
new
¶¶% (
Thread
¶¶) /
(
¶¶/ 0
Startup
¶¶0 7
)
¶¶7 8
{
·· 
Priority
¸¸  
=
¸¸! "
ThreadPriority
¸¸# 1
.
¸¸1 2
AboveNormal
¸¸2 =
,
¸¸= >
Name
¹¹ 
=
¹¹ 
$str
¹¹ 7
}
ºº 
;
ºº 
startup
»» 
.
»» 
Start
»» !
(
»»! "
)
»»" #
;
»»# $
startup
¼¼ 
.
¼¼ 
IsBackground
¼¼ (
=
¼¼) *
true
¼¼+ /
;
¼¼/ 0
startup
½½ 
.
½½ 
Join
½½  
(
½½  !"
SYSRESPONSE_INTERVAL
½½! 5
)
½½5 6
;
½½6 7
}
¾¾ 
}
¿¿ 
}
ÀÀ 	
public
ÈÈ 
void
ÈÈ 
Stop
ÈÈ 
(
ÈÈ 
)
ÈÈ 
{
ÉÉ 	
if
ÊÊ 
(
ÊÊ 
this
ÊÊ 
.
ÊÊ 
iServerState
ÊÊ !
==
ÊÊ" $ 
NeoSpinServerState
ÊÊ% 7
.
ÊÊ7 8
Starting
ÊÊ8 @
||
ÊÊA C
this
ÊÊD H
.
ÊÊH I
iServerState
ÊÊI U
==
ÊÊV X 
NeoSpinServerState
ÊÊY k
.
ÊÊk l
Running
ÊÊl s
)
ÊÊs t
{
ËË 
this
ÌÌ 
.
ÌÌ 
iServerState
ÌÌ !
=
ÌÌ" # 
NeoSpinServerState
ÌÌ$ 6
.
ÌÌ6 7
Stopping
ÌÌ7 ?
;
ÌÌ? @
lock
ÎÎ 
(
ÎÎ 
this
ÎÎ 
.
ÎÎ 
iStartStopLock
ÎÎ )
)
ÎÎ) *
{
ÏÏ 
Thread
ĞĞ 
shutdown
ĞĞ #
=
ĞĞ$ %
new
ĞĞ& )
Thread
ĞĞ* 0
(
ĞĞ0 1
Shutdown
ĞĞ1 9
)
ĞĞ9 :
{
ÑÑ 
Priority
ÒÒ  
=
ÒÒ! "
ThreadPriority
ÒÒ# 1
.
ÒÒ1 2
Highest
ÒÒ2 9
,
ÒÒ9 :
Name
ÓÓ 
=
ÓÓ 
$str
ÓÓ 8
,
ÓÓ8 9
IsBackground
ÔÔ $
=
ÔÔ% &
true
ÔÔ' +
}
ÕÕ 
;
ÕÕ 
shutdown
ÖÖ 
.
ÖÖ 
Start
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
shutdown
×× 
.
×× 
Join
×× !
(
××! ""
SYSRESPONSE_INTERVAL
××" 6
)
××6 7
;
××7 8
}
ØØ 
}
ÙÙ 
}
ÚÚ 	
private
ÜÜ 
static
ÜÜ 
void
ÜÜ 
CompileRules
ÜÜ (
(
ÜÜ( )
)
ÜÜ) *
{
İİ 	
try
ŞŞ 
{
ßß 
StringBuilder
àà 
lstrRulesError
àà ,
=
àà- .
new
àà/ 2
StringBuilder
àà3 @
(
àà@ A
)
ààA B
;
ààB C
ParsingResult
áá 
lobjLoadResult
áá ,
=
áá- .
	srvMainDB
áá/ 8
.
áá8 9%
LoadRulesAndExpressions
áá9 P
(
ááP Q
)
ááQ R
;
ááR S
RulesEngine
ââ 
.
ââ 
CompileRules
ââ (
(
ââ( )
false
ââ) .
)
ââ. /
;
ââ/ 0
RulesEngine
ãã 
.
ãã 
CompileRules
ãã (
(
ãã( )
true
ãã) -
)
ãã- .
;
ãã. /
}
ää 
catch
åå 
{
ææ 
}
çç 
}
èè 	
public
êê 
static
êê 
void
êê #
InitializeClassMapper
êê 0
(
êê0 1
)
êê1 2
{
ëë 	
System
ìì 
.
ìì 

Reflection
ìì 
.
ìì 
Assembly
ìì &
lasmSrcAssembly
ìì' 6
=
ìì7 8
null
ìì9 =
;
ìì= >
string
íí (
lstrBusinessObjectAssembly
íí -
=
íí. /(
NeoBaseApplicationSettings
íí0 J
.
ííJ K
Instance
ííK S
.
ííS T$
BusinessObjectAssembly
ííT j
;
ííj k
System
îî 
.
îî 

Reflection
îî 
.
îî 
Assembly
îî & 
lasmTargetAssembly
îî' 9
=
îî: ;
	AppDomain
îî< E
.
îîE F
CurrentDomain
îîF S
.
îîS T
GetAssemblies
îîT a
(
îîa b
)
îîb c
.
îîc d
Where
îîd i
(
îîi j
a
îîj k
=>
îîl n
a
îîo p
.
îîp q
GetName
îîq x
(
îîx y
)
îîy z
.
îîz {
Name
îî{ 
==îî€ ‚*
lstrBusinessObjectAssemblyîîƒ 
)îî 
.îî Ÿ
FirstOrDefaultîîŸ ­
(îî­ ®
)îî® ¯
;îî¯ °
if
ïï 
(
ïï  
lasmTargetAssembly
ïï "
.
ïï" #
	IsNotNull
ïï# ,
(
ïï, -
)
ïï- .
)
ïï. /
{
ğğ 

Collection
ññ 
<
ññ 
Type
ññ 
>
ññ  
lcolType
ññ! )
=
ññ* +
new
ññ, /

Collection
ññ0 :
<
ññ: ;
Type
ññ; ?
>
ññ? @
{
òò 
typeof
óó 
(
óó 
busBase
óó "
)
óó" #
,
óó# $
typeof
ôô 
(
ôô 
doBase
ôô !
)
ôô! "
}
õõ 
;
õõ 
List
üü 
<
üü #
utlCustomAssemblyInfo
üü *
>
üü* +$
llstCustomAssemblyInfo
üü, B
=
üüC D
(
üüE F
List
üüF J
<
üüJ K#
utlCustomAssemblyInfo
üüK `
>
üü` a
)
üüa b
HelperFunction
üüb p
.
üüp q
JsonDeserializeüüq €
(üü€ 
SystemSettingsüü 
.üü 
Instanceüü ˜
.üü˜ ™"
CustomAssemblyInfoüü™ «
,üü« ¬
typeofüü­ ³
(üü³ ´
Listüü´ ¸
<üü¸ ¹%
utlCustomAssemblyInfoüü¹ Î
>üüÎ Ï
)üüÏ Ğ
)üüĞ Ñ
;üüÑ Ò
foreach
şş 
(
şş #
utlCustomAssemblyInfo
şş .
item
şş/ 3
in
şş4 6$
llstCustomAssemblyInfo
şş7 M
)
şşM N
{
ÿÿ 
if
€€ 
(
€€ 
item
€€ 
!=
€€ 
null
€€  $
)
€€$ %
{
 
lasmSrcAssembly
‚‚ '
=
‚‚( )
Assembly
‚‚* 2
.
‚‚2 3
LoadFile
‚‚3 ;
(
‚‚; <
Path
‚‚< @
.
‚‚@ A
Combine
‚‚A H
(
‚‚H I
	AppDomain
‚‚I R
.
‚‚R S
CurrentDomain
‚‚S `
.
‚‚` a
BaseDirectory
‚‚a n
,
‚‚n o
item
‚‚p t
.
‚‚t u
Assembly
‚‚u }
+
‚‚~ 
$str‚‚€ †
)‚‚† ‡
)‚‚‡ ˆ
;‚‚ˆ ‰
ClassMapper
ƒƒ #
.
ƒƒ# $#
LoadSolutionSideTypes
ƒƒ$ 9
(
ƒƒ9 :
lasmSrcAssembly
ƒƒ: I
,
ƒƒI J 
lasmTargetAssembly
ƒƒK ]
,
ƒƒ] ^
lcolType
ƒƒ_ g
)
ƒƒg h
;
ƒƒh i
}
„„ 
}
…… 
lasmSrcAssembly
‹‹ 
=
‹‹  !
typeof
‹‹" (
(
‹‹( ) 
ExtendedBPMService
‹‹) ;
)
‹‹; <
.
‹‹< =
Assembly
‹‹= E
;
‹‹E F
lcolType
ŒŒ 
.
ŒŒ 
Clear
ŒŒ 
(
ŒŒ 
)
ŒŒ  
;
ŒŒ  !
lcolType
 
.
 
Add
 
(
 
typeof
 #
(
# $ 
ExtendedBPMService
$ 6
)
6 7
)
7 8
;
8 9
ClassMapper
 
.
 #
LoadSolutionSideTypes
 1
(
1 2
lasmSrcAssembly
2 A
,
A B 
lasmTargetAssembly
C U
,
U V
lcolType
W _
)
_ `
;
` a
}
 
}
 	
public
šš 
static
šš 
void
šš ,
StartThreadToRefreshDBSettings
šš 9
(
šš9 :
)
šš: ;
{
›› 	
string
œœ #
lstrRefreshDBSettings
œœ (
=
œœ) *"
ConfigurationManager
œœ+ ?
.
œœ? @
AppSettings
œœ@ K
[
œœK L
$str
œœL \
]
œœ\ ]
;
œœ] ^
bool
 #
lblnRefreshDBSettings
 &
=
' (#
lstrRefreshDBSettings
) >
==
? A
null
B F
?
G H(
NeoBaseApplicationSettings
I c
.
c d
Instance
d l
.
l m
RefreshDBCache
m {
:
| }
Convert~ …
.… †
	ToBoolean† 
( %
lstrRefreshDBSettings ¥
)¥ ¦
;¦ §
if
ŸŸ 
(
ŸŸ #
lblnRefreshDBSettings
ŸŸ %
)
ŸŸ% &
{
   #
utlCacheRefreshHelper
¡¡ %
.
¡¡% &,
StartThreadToRefreshDBSettings
¡¡& D
(
¡¡D E
)
¡¡E F
;
¡¡F G
}
¢¢ 
}
££ 	
}
¦¦ 
}§§ Šu
MC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\frmBPMNService.cs
	namespace 	
NeoBPMN
 
. 
Service 
{ 
public 

partial 
class 
frmBPMNService '
:( )
Form* .
{ 
string,, 
[,, 
],, 
	arguments,, 
;,, 
privateaa 
ICollectionaa 
<aa 
ServiceHostaa '
>aa' (
_icolServiceHostsaa) :
;aa: ;
publicgg 
frmBPMNServicegg 
(gg 
stringgg $
[gg$ %
]gg% &
argsgg' +
)gg+ ,
{hh 	
thisii 
.ii 
	argumentsii 
=ii 
argsii !
;ii! "
thisjj 
.jj 
_icolServiceHostsjj "
=jj# $
newjj% (

Collectionjj) 3
<jj3 4
ServiceHostjj4 ?
>jj? @
(jj@ A
)jjA B
;jjB C
InitializeComponentkk 
(kk  
)kk  !
;kk! "
}ll 	
private
éé 
void
éé +
frmNeoFlowService_FormClosing
éé 2
(
éé2 3
object
éé3 9
sender
éé: @
,
éé@ A"
FormClosingEventArgs
ééB V
e
ééW X
)
ééX Y
{
êê 	 
ExtendedBPMService
ìì 
.
ìì 
Instance
ìì '
.
ìì' (
Stop
ìì( ,
(
ìì, -
)
ìì- .
;
ìì. /
StopServiceHosts
íí 
(
íí 
)
íí 
;
íí 
}
îî 	
private
õõ 
void
õõ "
frmBPMNService_Shown
õõ )
(
õõ) *
object
õõ* 0
sender
õõ1 7
,
õõ7 8
	EventArgs
õõ9 B

aEventArgs
õõC M
)
õõM N
{
öö 	
	lblStatus
øø 
.
øø 
Text
øø 
=
øø 
$str
øø D
;
øøD E
Application
ùù 
.
ùù 
DoEvents
ùù  
(
ùù  !
)
ùù! "
;
ùù" #
if
úú 
(
úú 
!
úú 
InitializeCache
úú  
(
úú  !
)
úú! "
)
úú" #
{
ûû 
this
üü 
.
üü 
Close
üü 
(
üü 
)
üü 
;
üü 
return
ıı 
;
ıı 
}
şş  
ExtendedBPMService
„„ 
.
„„ 

Initialize
„„ )
(
„„) *
	arguments
„„* 3
)
„„3 4
;
„„4 5 
ExtendedBPMService
…… 
.
…… 
Instance
…… '
.
……' (
Start
……( -
(
……- .
)
……. /
;
……/ 0
InitServiceHosts
†† 
(
†† 
)
†† 
;
†† 
}
‡‡ 	
private
 
void
 
btnClose_Click
 #
(
# $
object
$ *
sender
+ 1
,
1 2
	EventArgs
3 <

aEventArgs
= G
)
G H
{
 	
this
 
.
 
Close
 
(
 
)
 
;
 
}
‘‘ 	
private
˜˜ 
void
˜˜ +
btnRefreshMetaDataCache_Click
˜˜ 2
(
˜˜2 3
object
˜˜3 9
sender
˜˜: @
,
˜˜@ A
	EventArgs
˜˜B K

aEventArgs
˜˜L V
)
˜˜V W
{
™™ 	 
ExtendedBPMService
›› 
.
›› 
Instance
›› '
.
››' (
Suspend
››( /
(
››/ 0
)
››0 1
;
››1 2
this
œœ 
.
œœ 
LoadMetaDataCache
œœ "
(
œœ" #
)
œœ# $
;
œœ$ % 
ExtendedBPMService
 
.
 
Instance
 '
.
' (
Resume
( .
(
. /
)
/ 0
;
0 1
}
ŸŸ 	
private
¦¦ 
void
¦¦ %
btnRefreshDBCache_Click
¦¦ ,
(
¦¦, -
object
¦¦- 3
sender
¦¦4 :
,
¦¦: ;
	EventArgs
¦¦< E

aEventArgs
¦¦F P
)
¦¦P Q
{
§§ 	 
ExtendedBPMService
©© 
.
©© 
Instance
©© '
.
©©' (
Suspend
©©( /
(
©©/ 0
)
©©0 1
;
©©1 2
this
ªª 
.
ªª 
LoadDBCache
ªª 
(
ªª 
)
ªª 
;
ªª  
ExtendedBPMService
¬¬ 
.
¬¬ 
Instance
¬¬ '
.
¬¬' (
Resume
¬¬( .
(
¬¬. /
)
¬¬/ 0
;
¬¬0 1
}
­­ 	
private
´´ 
void
´´ #
btnRefreshRules_Click
´´ *
(
´´* +
object
´´+ 1
sender
´´2 8
,
´´8 9
	EventArgs
´´: C
e
´´D E
)
´´E F
{
µµ 	 
ExtendedBPMService
·· 
.
·· 
Instance
·· '
.
··' (
Suspend
··( /
(
··/ 0
)
··0 1
;
··1 2
this
¸¸ 
.
¸¸ 
ExecuteRules
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸   
ExtendedBPMService
ºº 
.
ºº 
Instance
ºº '
.
ºº' (
Resume
ºº( .
(
ºº. /
)
ºº/ 0
;
ºº0 1
(
»» 
new
»» 

busNeoBase
»» 
(
»» 
)
»» 
)
»» 
.
»» '
InitializeExtendedObjects
»» 8
(
»»8 9
)
»»9 :
;
»»: ;
}
¼¼ 	
private
áá 
void
áá 
CacheBpmCase
áá !
(
áá! "
)
áá" #
{
ââ 	
}
èè 	
private
İ	İ	 
int
İ	İ	 (
GetDocumentAttachmentCount
İ	İ	 .
(
İ	İ	. /
string
İ	İ	/ 5
astrECMGuid
İ	İ	6 A
)
İ	İ	A B
{
Ş	Ş	 	
return
à	à	 
$num
à	à	 
;
à	à	 
}
á	á	 	
private
¢¢ 
bool
¢¢ 
InitializeCache
¢¢ $
(
¢¢$ %
)
¢¢% &
{
££ 	
try
¤¤ 
{
¥¥ 
LoadMetaDataCache
¦¦ !
(
¦¦! "
)
¦¦" #
;
¦¦# $
LoadDBCache
§§ 
(
§§ 
)
§§ 
;
§§ 
ExecuteRules
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
CacheBpmCase
ªª 
(
ªª 
)
ªª 
;
ªª 
CorBookmarkHelper
«« !
.
««! "'
CacheTemplateStdBookmarks
««" ;
(
««; <
)
««< =
;
««= >
(
¬¬ 
new
¬¬ 

busNeoBase
¬¬ 
(
¬¬  
)
¬¬  !
)
¬¬! "
.
¬¬" #'
InitializeExtendedObjects
¬¬# <
(
¬¬< =
)
¬¬= >
;
¬¬> ?
NeoSpinServer
­­ 
.
­­ #
InitializeClassMapper
­­ 3
(
­­3 4
)
­­4 5
;
­­5 6
NeoSpinServer
®® 
.
®® ,
StartThreadToRefreshDBSettings
®® <
(
®®< =
)
®®= >
;
®®> ?#
utlCacheRefreshHelper
¯¯ %
.
¯¯% &,
StartThreadToRefreshDBSettings
¯¯& D
(
¯¯D E
)
¯¯E F
;
¯¯F G
return
°° 
true
°° 
;
°° 
}
±± 
catch
²² 
(
²² 
	Exception
²² 
er
²² 
)
²²  
{
³³ 

MessageBox
´´ 
.
´´ 
Show
´´ 
(
´´  
$str
´´  L
+
´´M N
er
´´O Q
.
´´Q R
Message
´´R Y
+
´´Z [
$str
´´\ `
+
´´a b
er
´´c e
.
´´e f

StackTrace
´´f p
.
´´p q
ToString
´´q y
(
´´y z
)
´´z {
)
´´{ |
;
´´| }
return
µµ 
false
µµ 
;
µµ 
}
¶¶ 
}
·· 	
private
¼¼ 
void
¼¼ 
LoadMetaDataCache
¼¼ &
(
¼¼& '
)
¼¼' (
{
½½ 	
	lblStatus
¾¾ 
.
¾¾ 
Text
¾¾ 
=
¾¾ 
$str
¾¾ 3
;
¾¾3 4
Application
¿¿ 
.
¿¿ 
DoEvents
¿¿  
(
¿¿  !
)
¿¿! "
;
¿¿" #
srvMetaDataCache
ÀÀ 
.
ÀÀ 
LoadXMLCache
ÀÀ )
(
ÀÀ) *
)
ÀÀ* +
;
ÀÀ+ ,
	lblStatus
ÁÁ 
.
ÁÁ 
Text
ÁÁ 
=
ÁÁ 
$str
ÁÁ =
;
ÁÁ= >
Application
ÂÂ 
.
ÂÂ 
DoEvents
ÂÂ  
(
ÂÂ  !
)
ÂÂ! "
;
ÂÂ" #
}
ÃÃ 	
private
ÈÈ 
void
ÈÈ 
LoadDBCache
ÈÈ  
(
ÈÈ  !
)
ÈÈ! "
{
ÉÉ 	
	lblStatus
ÊÊ 
.
ÊÊ 
Text
ÊÊ 
=
ÊÊ 
$str
ÊÊ 2
;
ÊÊ2 3
Application
ËË 
.
ËË 
DoEvents
ËË  
(
ËË  !
)
ËË! "
;
ËË" #
bool
ÌÌ 
lblnSuccess
ÌÌ 
=
ÌÌ 

srvDBCache
ÌÌ )
.
ÌÌ) *
LoadCacheInfo
ÌÌ* 7
(
ÌÌ7 8
)
ÌÌ8 9
;
ÌÌ9 :
if
ÍÍ 
(
ÍÍ 
!
ÍÍ 
lblnSuccess
ÍÍ 
)
ÍÍ 
{
ÎÎ 

MessageBox
ÏÏ 
.
ÏÏ 
Show
ÏÏ 
(
ÏÏ  

srvDBCache
ÏÏ  *
.
ÏÏ* +

istrResult
ÏÏ+ 5
)
ÏÏ5 6
;
ÏÏ6 7
Close
ĞĞ 
(
ĞĞ 
)
ĞĞ 
;
ĞĞ 
}
ÑÑ 
else
ÒÒ 
{
ÓÓ 
	lblStatus
ÔÔ 
.
ÔÔ 
Text
ÔÔ 
=
ÔÔ  
$str
ÔÔ! @
;
ÔÔ@ A
Application
ÕÕ 
.
ÕÕ 
DoEvents
ÕÕ $
(
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
ÖÖ 
}
×× 	
private
ÜÜ 
void
ÜÜ 
ExecuteRules
ÜÜ !
(
ÜÜ! "
)
ÜÜ" #
{
İİ 	
	lblStatus
ŞŞ 
.
ŞŞ 
Text
ŞŞ 
=
ŞŞ 
$str
ŞŞ 1
;
ŞŞ1 2
Application
ßß 
.
ßß 
DoEvents
ßß  
(
ßß  !
)
ßß! "
;
ßß" #
utlPassInfo
àà 
.
àà 
iobjPassInfo
àà $
=
àà% &
new
àà' *
utlPassInfo
àà+ 6
(
àà6 7
)
àà7 8
;
àà8 9
ParsingResult
áá 

lobjResult
áá $
=
áá% &
RulesEngine
áá' 2
.
áá2 3%
LoadRulesAndExpressions
áá3 J
(
ááJ K
utlPassInfo
ááK V
.
ááV W
iobjPassInfo
ááW c
.
áác d
iconFramework
áád q
,
ááq r
utlPassInfo
áás ~
.
áá~ 
iobjPassInfoáá ‹
.áá‹ Œ
itrnFrameworkááŒ ™
)áá™ š
;ááš ›
if
ââ 
(
ââ 

lobjResult
ââ 
.
ââ 

ilstErrors
ââ %
.
ââ% &
Count
ââ& +
>
ââ, -
$num
ââ. /
)
ââ/ 0
{
ãã 
StringBuilder
ää 
lstrRuleErrors
ää ,
=
ää- .
new
ää/ 2
StringBuilder
ää3 @
(
ää@ A
)
ääA B
;
ääB C
lstrRuleErrors
åå 
.
åå 

AppendLine
åå )
(
åå) *
$str
åå* :
)
åå: ;
;
åå; <
foreach
ææ 
(
ææ 
utlRuleMessage
ææ '
lobjMessage
ææ( 3
in
ææ4 6

lobjResult
ææ7 A
.
ææA B

ilstErrors
ææB L
)
ææL M
{
çç 
lstrRuleErrors
èè "
.
èè" #

AppendLine
èè# -
(
èè- .
string
èè. 4
.
èè4 5
Format
èè5 ;
(
èè; <
$str
èè< e
,
èèe f
lobjMessage
éé #
.
éé# $
istrObjectID
éé$ 0
,
éé0 1
lobjMessage
éé2 =
.
éé= >

istrRuleID
éé> H
,
ééH I
lobjMessage
ééJ U
.
ééU V
istrMessage
ééV a
)
ééa b
)
ééb c
;
ééc d
}
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
lstrRuleErrors
ëë  .
.
ëë. /
ToString
ëë/ 7
(
ëë7 8
)
ëë8 9
)
ëë9 :
;
ëë: ;
}
ìì 
else
íí 
{
îî 
	lblStatus
ïï 
.
ïï 
Text
ïï 
=
ïï  
$str
ïï! (
;
ïï( )
Application
ğğ 
.
ğğ 
DoEvents
ğğ $
(
ğğ$ %
)
ğğ% &
;
ğğ& '
}
ññ 
}
òò 	
private
õõ 
void
õõ 
InitServiceHosts
õõ %
(
õõ% &
)
õõ& '
{
öö 	
System
÷÷ 
.
÷÷ 
ServiceModel
÷÷ 
.
÷÷  
Channels
÷÷  (
.
÷÷( )
Binding
÷÷) 0
lntbBinding
÷÷1 <
=
÷÷= >
ServiceHelper
÷÷? L
.
÷÷L M
GetNetTcpBinding
÷÷M ]
(
÷÷] ^
true
÷÷^ b
)
÷÷b c
;
÷÷c d
string
øø 
lstrBaseUrl
øø 
=
øø  "
ConfigurationManager
øø! 5
.
øø5 6
AppSettings
øø6 A
[
øøA B
$str
øøB P
]
øøP Q
;
øøQ R
if
ùù 
(
ùù 
!
ùù 
string
ùù 
.
ùù  
IsNullOrWhiteSpace
ùù *
(
ùù* +
lstrBaseUrl
ùù+ 6
)
ùù6 7
)
ùù7 8
{
úú 
this
ûû 
.
ûû 
_icolServiceHosts
ûû &
.
ûû& '
Add
ûû' *
(
ûû* +
ServiceHelper
ûû+ 8
.
ûû8 9
GetServiceHost
ûû9 G
<
ûûG H
IBusinessTier
ûûH U
>
ûûU V
(
ûûV W
typeof
ûûW ]
(
ûû] ^
	srvCommon
ûû^ g
)
ûûg h
,
ûûh i
string
üü 
.
üü 
Format
üü !
(
üü! "
lstrBaseUrl
üü" -
,
üü- .
$str
üü/ :
)
üü: ;
,
üü; <
lntbBinding
üü= H
)
üüH I
)
üüI J
;
üüJ K
}
ıı 
}
şş 	
private
€€ 
void
€€ 
StopServiceHosts
€€ %
(
€€% &
)
€€& '
{
 	
foreach
‚‚ 
(
‚‚ 
ServiceHost
‚‚  
lobjServiceHost
‚‚! 0
in
‚‚1 3
_icolServiceHosts
‚‚4 E
)
‚‚E F
{
ƒƒ 
if
„„ 
(
„„ 
lobjServiceHost
„„ #
.
„„# $
State
„„$ )
==
„„* , 
CommunicationState
„„- ?
.
„„? @
Opened
„„@ F
)
„„F G
lobjServiceHost
…… #
.
……# $
Close
……$ )
(
……) *
)
……* +
;
……+ ,
}
†† 
}
‡‡ 	
}
ºº 
}»» è…
QC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\ExtendedBPMService.cs
	namespace 	
NeoBPMN
 
. 
Service 
{ 
public 

class 
ExtendedBPMService #
:$ %

BPMService& 0
{ 
public 
static 
void 

Initialize %
(% &
string& ,
[, -
]- .
args/ 3
)3 4
{ 	
string 
lstrServerName !
=" #
$str$ 1
;1 2
string 

lstrUserId 
= 
$str  -
;- .
int  
lintBpmQueueInterval $
=% &
$num' *
;* +
int *
lintMaxConcurrentQueueRequests .
=/ 0
$num1 3
;3 4
int $
lintDefaultTimerInterval (
=) *
$num+ 1
;1 2
string 
[ 
] 
details 
; 
if 
( 
args 
!= 
null 
&& 
args  $
.$ %
Length% +
>, -
$num. /
)/ 0
{ 
foreach 
( 
string 
arg  #
in$ &
args' +
)+ ,
{ 
details 
= 
arg !
.! "
Split" '
(' (
$char( +
)+ ,
;, -
switch 
( 
details #
[# $
$num$ %
]% &
)& '
{ 
case   
$str   )
:  ) *
lstrServerName!! *
=!!+ ,
details!!- 4
[!!4 5
$num!!5 6
]!!6 7
;!!7 8
break"" !
;""! "
case## 
$str## %
:##% &

lstrUserId$$ &
=$$' (
details$$) 0
[$$0 1
$num$$1 2
]$$2 3
;$$3 4
break%% !
;%%! "
case&& 
$str&& .
:&&. / 
lintBpmQueueInterval'' 0
=''1 2
Convert''3 :
.'': ;
ToInt32''; B
(''B C
details''C J
[''J K
$num''K L
]''L M
)''M N
;''N O
break(( !
;((! "
case)) 
$str)) 6
:))6 7*
lintMaxConcurrentQueueRequests** :
=**; <
Convert**= D
.**D E
ToInt32**E L
(**L M
details**M T
[**T U
$num**U V
]**V W
)**W X
;**X Y
;**Z [
break++ !
;++! "
case,, 
$str,, 3
:,,3 4$
lintDefaultTimerInterval-- 4
=--5 6
Convert--7 >
.--> ?
ToInt32--? F
(--F G
details--G N
[--N O
$num--O P
]--P Q
)--Q R
;--R S
;--T U
break.. !
;..! "
}// 
}00 
}11 
Type88 
type88 
=88 
ClassMapper88 #
.88# $&
GetSolutionSideDerivedType88$ >
(88> ?
typeof88? E
(88E F
ExtendedBPMService88F X
)88X Y
)88Y Z
;88Z [
if99 
(99 
type99 
!=99 
null99 
)99 
{:: 
	_instance;; 
=;; 
type;;  
.;;  !
GetConstructors;;! 0
(;;0 1
);;1 2
[;;2 3
$num;;3 4
];;4 5
.;;5 6
Invoke;;6 <
(;;< =
new;;= @
object;;A G
[;;G H
];;H I
{;;J K
lstrServerName;;L Z
,;;Z [

lstrUserId;;\ f
,;;f g 
lintBpmQueueInterval;;h |
,;;| }+
lintMaxConcurrentQueueRequests	;;~ œ
,
;;œ &
lintDefaultTimerInterval
;; ¶
}
;;· ¸
)
;;¸ ¹
as
;;º ¼ 
ExtendedBPMService
;;½ Ï
;
;;Ï Ğ
}<< 
if== 
(== 
	_instance== 
==== 
null==  
)==  !
{?? 
	_instance?? 
=?? 
new?? 
ExtendedBPMService?? 1
(??1 2
lstrServerName??2 @
,??@ A

lstrUserId??B L
,??L M 
lintBpmQueueInterval??N b
,??b c+
lintMaxConcurrentQueueRequests	??d ‚
,
??‚ ƒ&
lintDefaultTimerInterval
??„ œ
)
??œ 
;
?? 
}
??Ÿ  
}BB 	
staticCC 
ExtendedBPMServiceCC !
	_instanceCC" +
;CC+ ,
publicDD 
staticDD 
ExtendedBPMServiceDD (
InstanceDD) 1
{EE 	
getFF 
{GG 
returnHH 
	_instanceHH  
;HH  !
}II 
}JJ 	
staticKK 
ExtendedBPMServiceKK !
(KK! "
)KK" #
{LL 	
ilstActionMethodsMM 
=MM 
newMM  #
utlActionMethodsMM$ 4
(MM4 5
)MM5 6
;MM6 7
GetActionMethodsNN 
(NN 
typeofNN #
(NN# $

BPMServiceNN$ .
)NN. /
)NN/ 0
;NN0 1
}OO 	
	protectedPP 
ExtendedBPMServicePP $
(PP$ %
stringPP% +
astrServerNamePP, :
,PP: ;
stringPP< B

astrUserIdPPC M
,PPM N
intPPO R 
aintBpmQueueIntervalPPS g
=PPh i
$numPPj m
,PPm n
intPPo r+
aintMaxConcurrentQueueRequests	PPs ‘
=
PP’ “
$num
PP” –
,
PP– —
int
PP˜ ›&
aintDefaultTimerInterval
PPœ ´
=
PPµ ¶
$num
PP· ½
)
PP½ ¾
:
PP¿ À
base
PPÁ Å
(
PPÅ Æ
astrServerName
PPÆ Ô
,
PPÔ Õ

astrUserId
PPÖ à
,
PPà á"
aintBpmQueueInterval
PPâ ö
,
PPö ÷,
aintMaxConcurrentQueueRequests
PPø –
,
PP– —&
aintDefaultTimerInterval
PP˜ °
)
PP° ±
{QQ 	
}SS 	
	protectedUU 
overrideUU 
voidUU !
HandleDocumentRequestUU  5
(UU5 6
busBpmRequestUU6 C
abusBpmRequestUUD R
)UUR S
{VV 	
ifWW 
(WW 
abusBpmRequestWW 
.WW 
icdoBpmRequestWW -
.WW- .
tracking_idWW. 9
>WW: ;
$numWW< =
&&WW> @
abusBpmRequestXX &
.XX& '
icdoBpmRequestXX' 5
.XX5 6
reason_valueXX6 B
==XXC E
$strXXF L
)XXL M
{YY G
;InitializeUndeliveredDocumentProcessForPersonOrOrganization[[ K
([[K L
abusBpmRequest[[L Z
)[[Z [
;[[[ \
RequestProcessed\\  
(\\  !
abusBpmRequest\\! /
)\\/ 0
;\\0 1
}]] 
else^^ 
{__ 
if`` 
(`` 
abusBpmRequest`` "
.``" #
icdoBpmRequest``# 1
.``1 2
	doc_class``2 ;
==``< >
null``? C
)``C D
{aa 
busBpmEventbb 
	lbusEventbb  )
=bb* +
newbb, /
busBpmEventbb0 ;
(bb; <
)bb< =
;bb= >
abusBpmRequestcc "
.cc" #
icdoBpmRequestcc# 1
.cc1 2
	doc_classcc2 ;
=cc< =
	lbusEventcc> G
.ccG H&
FindDocClassBasedOnDocTypeccH b
(ccb c
abusBpmRequestccc q
.ccq r
icdoBpmRequest	ccr €
.
cc€ 
doc_type
cc ‰
,
cc‰ Š
abusBpmRequest
cc‹ ™
.
cc™ š
icdoBpmRequest
ccš ¨
.
cc¨ ©
	doc_class
cc© ²
,
cc² ³
true
cc´ ¸
)
cc¸ ¹
;
cc¹ º
;
cc» ¼
}dd 
baseff 
.ff !
HandleDocumentRequestff *
(ff* +
abusBpmRequestff+ 9
)ff9 :
;ff: ;
}gg 
}hh 	
	protectedjj 
overridejj 
voidjj 
RequestProcessedjj  0
(jj0 1
busBpmRequestjj1 >
abusBpmRequestjj? M
)jjM N
{kk 	
ifll 
(ll 
abusBpmRequestll 
.ll 
icdoBpmRequestll -
.ll- .
status_valuell. :
!=ll; =
BpmRequestStatusll> N
.llN O

RestrictedllO Y
)llY Z
basemm 
.mm 
RequestProcessedmm %
(mm% &
abusBpmRequestmm& 4
)mm4 5
;mm5 6
}nn 	
	protectedoo 
overrideoo 
voidoo )
PostProcessingDocumentRequestoo  =
(oo= >
busBpmRequestoo> K
abusBpmRequestooL Z
)ooZ [
{pp 	 
busNeobaseBpmRequestqq  !
lbusNeobaseBpmRequestqq! 6
=qq7 8
ClassMapperqq9 D
.qqD E
	GetObjectqqE N
<qqN O 
busNeobaseBpmRequestqqO c
>qqc d
(qqd e
)qqe f
;qqf g!
lbusNeobaseBpmRequestss !
.ss! "$
IncomingDocumentReceivedss" :
(ss: ;
abusBpmRequestss; I
)ssI J
;ssJ K
}tt 	
privatezz 
voidzz G
;InitializeUndeliveredDocumentProcessForPersonOrOrganizationzz P
(zzP Q
busBpmRequestzzQ ^
abusBpmRequestzz_ m
)zzm n
{{{ 	 
busNeobaseBpmRequest~~  !
lbusNeobaseBpmRequest~~! 6
=~~7 8
ClassMapper~~9 D
.~~D E
	GetObject~~E N
<~~N O 
busNeobaseBpmRequest~~O c
>~~c d
(~~d e
)~~e f
;~~f g!
lbusNeobaseBpmRequest !
.! "$
IncomingDocumentReceived" :
(: ;
abusBpmRequest; I
)I J
;J K
if
 
(
 
abusBpmRequest
 
.
 
icdoBpmRequest
 -
.
- .
	person_id
. 7
>
8 9
$num
: ;
)
; <
{
‚‚ 
busBpmProcess
ƒƒ 
lbusBpmProcess
ƒƒ ,
=
ƒƒ- .+
busNeobaseBpmActivityInstance
ƒƒ/ L
.
ƒƒL M
GetBpmProcess
ƒƒM Z
(
ƒƒZ [
$strƒƒ[ €
,ƒƒ€ 
$strƒƒ‚ ¦
,ƒƒ¦ §
utlPassInfoƒƒ¨ ³
.ƒƒ³ ´
iobjPassInfoƒƒ´ À
)ƒƒÀ Á
;ƒƒÁ Â
if
…… 
(
…… 
lbusBpmProcess
…… "
.
……" #
icdoBpmProcess
……# 1
.
……1 2

process_id
……2 <
>
……= >
$num
……? @
)
……@ A
{
†† 
abusBpmRequest
‡‡ "
.
‡‡" #
icdoBpmRequest
‡‡# 1
.
‡‡1 2

process_id
‡‡2 <
=
‡‡= >
lbusBpmProcess
‡‡? M
.
‡‡M N
icdoBpmProcess
‡‡N \
.
‡‡\ ]

process_id
‡‡] g
;
‡‡g h$
busBpmRequestParameter
ŠŠ *%
lbusBpmRequestParameter
ŠŠ+ B
=
ŠŠC D
new
ŠŠE H$
busBpmRequestParameter
ŠŠI _
(
ŠŠ_ `
)
ŠŠ` a
{
ŠŠb c%
icdoBpmRequestParameter
ŠŠd {
=
ŠŠ| }
newŠŠ~ %
doBpmRequestParameterŠŠ‚ —
(ŠŠ— ˜
)ŠŠ˜ ™
}ŠŠš ›
;ŠŠ› œ%
lbusBpmRequestParameter
‹‹ +
.
‹‹+ ,%
icdoBpmRequestParameter
‹‹, C
.
‹‹C D

request_id
‹‹D N
=
‹‹O P
abusBpmRequest
‹‹Q _
.
‹‹_ `
icdoBpmRequest
‹‹` n
.
‹‹n o

request_id
‹‹o y
;
‹‹y z%
lbusBpmRequestParameter
ŒŒ +
.
ŒŒ+ ,%
icdoBpmRequestParameter
ŒŒ, C
.
ŒŒC D
parameter_name
ŒŒD R
=
ŒŒS T
$str
ŒŒU a
;
ŒŒa b%
lbusBpmRequestParameter
 +
.
+ ,%
icdoBpmRequestParameter
, C
.
C D
parameter_value
D S
=
T U
abusBpmRequest
V d
.
d e
icdoBpmRequest
e s
.
s t
tracking_id
t 
. €
ToString€ ˆ
(ˆ ‰
)‰ Š
;Š ‹%
lbusBpmRequestParameter
 +
.
+ ,%
icdoBpmRequestParameter
, C
.
C D
Insert
D J
(
J K
)
K L
;
L M
abusBpmRequest
 "
.
" #%
iclbBpmRequestParameter
# :
.
: ;
Add
; >
(
> ?%
lbusBpmRequestParameter
? V
)
V W
;
W X 
busBpmCaseInstance
‘‘ &!
lbusBpmCaseInstance
‘‘' :
=
‘‘; <"
InitiateCaseInstance
‘‘= Q
(
‘‘Q R
abusBpmRequest
‘‘R `
)
‘‘` a
;
‘‘a b
if
““ 
(
““ !
lbusBpmCaseInstance
““ +
!=
““, .
null
““/ 3
)
““3 4
{
”” -
AttachDocumentToProcessInstance
•• 7
(
••7 8
abusBpmRequest
••8 F
,
••F G!
lbusBpmCaseInstance
••H [
.
••[ \$
iclbBpmProcessInstance
••\ r
[
••r s
$num
••s t
]
••t u
,
••u v
null
••w {
)
••{ |
;
••| }
}
–– 
}
—— 
}
˜˜ 
else
™™ 
if
™™ 
(
™™ 
abusBpmRequest
™™ #
.
™™# $
icdoBpmRequest
™™$ 2
.
™™2 3
org_id
™™3 9
>
™™: ;
$num
™™< =
)
™™= >
{
šš 
busBpmProcess
›› 
lbusBpmProcess
›› ,
=
››- .+
busNeobaseBpmActivityInstance
››/ L
.
››L M
GetBpmProcess
››M Z
(
››Z [
$str››[ …
,››… †
$str››‡ ±
,››± ²
utlPassInfo››³ ¾
.››¾ ¿
iobjPassInfo››¿ Ë
)››Ë Ì
;››Ì Í
if
 
(
 
lbusBpmProcess
 "
.
" #
icdoBpmProcess
# 1
.
1 2

process_id
2 <
>
= >
$num
? @
)
@ A
{
 
abusBpmRequest
ŸŸ "
.
ŸŸ" #
icdoBpmRequest
ŸŸ# 1
.
ŸŸ1 2

process_id
ŸŸ2 <
=
ŸŸ= >
lbusBpmProcess
ŸŸ? M
.
ŸŸM N
icdoBpmProcess
ŸŸN \
.
ŸŸ\ ]

process_id
ŸŸ] g
;
ŸŸg h$
busBpmRequestParameter
¢¢ *%
lbusBpmRequestParameter
¢¢+ B
=
¢¢C D
new
¢¢E H$
busBpmRequestParameter
¢¢I _
(
¢¢_ `
)
¢¢` a
{
¢¢b c%
icdoBpmRequestParameter
¢¢d {
=
¢¢| }
new¢¢~ %
doBpmRequestParameter¢¢‚ —
(¢¢— ˜
)¢¢˜ ™
}¢¢š ›
;¢¢› œ%
lbusBpmRequestParameter
££ +
.
££+ ,%
icdoBpmRequestParameter
££, C
.
££C D

request_id
££D N
=
££O P
abusBpmRequest
££Q _
.
££_ `
icdoBpmRequest
££` n
.
££n o

request_id
££o y
;
££y z%
lbusBpmRequestParameter
¤¤ +
.
¤¤+ ,%
icdoBpmRequestParameter
¤¤, C
.
¤¤C D
parameter_name
¤¤D R
=
¤¤S T
$str
¤¤U a
;
¤¤a b%
lbusBpmRequestParameter
¥¥ +
.
¥¥+ ,%
icdoBpmRequestParameter
¥¥, C
.
¥¥C D
parameter_value
¥¥D S
=
¥¥T U
abusBpmRequest
¥¥V d
.
¥¥d e
icdoBpmRequest
¥¥e s
.
¥¥s t
tracking_id
¥¥t 
.¥¥ €
ToString¥¥€ ˆ
(¥¥ˆ ‰
)¥¥‰ Š
;¥¥Š ‹%
lbusBpmRequestParameter
¦¦ +
.
¦¦+ ,%
icdoBpmRequestParameter
¦¦, C
.
¦¦C D
Insert
¦¦D J
(
¦¦J K
)
¦¦K L
;
¦¦L M
abusBpmRequest
§§ "
.
§§" #%
iclbBpmRequestParameter
§§# :
.
§§: ;
Add
§§; >
(
§§> ?%
lbusBpmRequestParameter
§§? V
)
§§V W
;
§§W X 
busBpmCaseInstance
¨¨ &!
lbusBpmCaseInstance
¨¨' :
=
¨¨; <"
InitiateCaseInstance
¨¨= Q
(
¨¨Q R
abusBpmRequest
¨¨R `
)
¨¨` a
;
¨¨a b
if
©© 
(
©© !
lbusBpmCaseInstance
©© +
!=
©©, .
null
©©/ 3
)
©©3 4
{
ªª -
AttachDocumentToProcessInstance
«« 7
(
««7 8
abusBpmRequest
««8 F
,
««F G!
lbusBpmCaseInstance
««H [
.
««[ \$
iclbBpmProcessInstance
««\ r
[
««r s
$num
««s t
]
««t u
,
««u v
null
««w {
)
««{ |
;
««| }
}
¬¬ 
}
­­ 
}
®® 
}
°° 	
}
²² 
}³³ ï

TC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\NeoSpinBPMEngine\..\GlobalAssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str /
)/ 0
]0 1
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str B
)B C
]C D
[		 
assembly		 	
:			 

AssemblyTrademark		 
(		 
$str		 :
)		: ;
]		; <
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyVersion 
( 
$str $
)$ %
]% &
[ 
assembly 	
:	 

AssemblyFileVersion 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 
(
AssemblyInformationalVersion '
(' (
$str( 8
)8 9
]9 :