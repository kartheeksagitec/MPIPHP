‡
\C:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\EncryptionClassLibrary\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 1
)1 2
]2 3
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 3
)3 4
]4 5
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *•Ý
SC:\Sonarqube Codebase\MPIBPM_DEV\slnMPIPHP\EncryptionClassLibrary\EncryptDecrypt.cs
	namespace 	,
 EncryptionDecryptionClassLibrary
 *
{		 
public

 

class

 
EncryptDecrypt

 
{ 
[ 	
SqlProcedure	 
] 
public 
static 
void 
OpusEncrypt &
(& '
string' -
astrText. 6
,6 7
out8 ;
	SqlString< E
astrEncryptedF S
)S T
{ 	
astrEncrypted 
= 
string "
." #
Empty# (
;( )
string 
astrKey 
= 
$str ?
;? @
stringA G
astrIVH N
=O P
$strQ c
;c d
try 
{ 
if 
( 
string 
. 
IsNullOrEmpty (
(( )
astrText) 1
)1 2
)2 3
astrEncrypted 
= 
string %
.% &
Empty& +
;+ ,
if 
( 
string 
. 
IsNullOrEmpty $
($ %
astrKey% ,
), -
)- .
throw 
new !
ArgumentNullException /
(/ 0
$str0 9
,9 :
$str; ]
)] ^
;^ _
if 
( 
string 
. 
IsNullOrEmpty $
($ %
astrIV% +
)+ ,
), -
throw 
new !
ArgumentNullException /
(/ 0
$str0 8
,8 9
$str: \
)\ ]
;] ^
if 
( 
astrKey 
. 
Length 
!= !
$num" $
)$ %
throw 
new 
ArgumentException +
(+ ,
$str, M
,M N
$strO X
)X Y
;Y Z
if   
(   
astrIV   
.   
Length   
!=    
$num  ! #
)  # $
throw!! 
new!! 
ArgumentException!! +
(!!+ ,
$str!!, L
,!!L M
$str!!N V
)!!V W
;!!W X
string## 

lstrResult## 
=## 
string##  &
.##& '
Empty##' ,
;##, -
using%% 
(%% 

AesManaged%% 
aesAlg%% $
=%%% &
new%%' *

AesManaged%%+ 5
(%%5 6
)%%6 7
)%%7 8
{&& 
aesAlg(( 
.(( 
KeySize(( 
=((  
$num((! $
;(($ %
aesAlg)) 
.)) 
Key)) 
=)) 
ASCIIEncoding)) *
.))* +
ASCII))+ 0
.))0 1
GetBytes))1 9
())9 :
astrKey)): A
)))A B
;))B C
aesAlg** 
.** 
IV** 
=** 
ASCIIEncoding** )
.**) *
ASCII*** /
.**/ 0
GetBytes**0 8
(**8 9
astrIV**9 ?
)**? @
;**@ A
ICryptoTransform--  
	encryptor--! *
=--+ ,
aesAlg--- 3
.--3 4
CreateEncryptor--4 C
(--C D
aesAlg--D J
.--J K
Key--K N
,--N O
aesAlg--P V
.--V W
IV--W Y
)--Y Z
;--Z [
using00 
(00 
MemoryStream00 #
	msEncrypt00$ -
=00. /
new000 3
MemoryStream004 @
(00@ A
)00A B
)00B C
{11 
using22 
(22 
CryptoStream22 '
	csEncrypt22( 1
=222 3
new224 7
CryptoStream228 D
(22D E
	msEncrypt22E N
,22N O
	encryptor22P Y
,22Y Z
CryptoStreamMode22[ k
.22k l
Write22l q
)22q r
)22r s
{33 
using44 
(44 
StreamWriter44 +
	swEncrypt44, 5
=446 7
new448 ;
StreamWriter44< H
(44H I
	csEncrypt44I R
)44R S
)44S T
{55 
	swEncrypt77 %
.77% &
Write77& +
(77+ ,
astrText77, 4
)774 5
;775 6
}88 
byte:: 
[:: 
]:: 

cryptoByte:: )
=::* +
	msEncrypt::, 5
.::5 6
ToArray::6 =
(::= >
)::> ?
;::? @

lstrResult;; "
=;;# $
Convert;;% ,
.;;, -
ToBase64String;;- ;
(;;; <

cryptoByte;;< F
,;;F G
$num;;H I
,;;I J

cryptoByte;;K U
.;;U V
	GetLength;;V _
(;;_ `
$num;;` a
);;a b
);;b c
;;;c d
}<< 
}== 
}>> 
astrEncryptedAA 
=AA 

lstrResultAA &
;AA& '
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
astrEncryptedEE 
=EE 
stringEE  &
.EE& '
EmptyEE' ,
;EE, -
}FF 
}HH 	
[KK 	
SqlProcedureKK	 
]KK 
publicLL 
staticLL 
voidLL 
OpusDecryptLL '
(LL' (
stringLL( .
astrEncryptedLL/ <
,LL< =
outLL> A
	SqlStringLLB K
astrTextLLL T
)LLT U
{MM 	
stringOO 
astrKeyOO 
=OO 
$strOO ?
;OO? @
stringOOA G
astrIVOOH N
=OOO P
$strOOQ c
;OOc d
tryQQ 
{RR 
ifSS 
(SS 
stringSS 
.SS 
IsNullOrEmptySS (
(SS( )
astrEncryptedSS) 6
)SS6 7
)SS7 8
{TT 
astrTextUU 
=UU 
stringUU %
.UU% &
EmptyUU& +
;UU+ ,
returnVV 
;VV 
}WW 
ifYY 
(YY 
stringYY 
.YY 
IsNullOrEmptyYY (
(YY( )
astrKeyYY) 0
)YY0 1
)YY1 2
throwZZ 
newZZ !
ArgumentNullExceptionZZ 3
(ZZ3 4
$strZZ4 =
,ZZ= >
$strZZ? a
)ZZa b
;ZZb c
if[[ 
([[ 
string[[ 
.[[ 
IsNullOrEmpty[[ (
([[( )
astrIV[[) /
)[[/ 0
)[[0 1
throw\\ 
new\\ !
ArgumentNullException\\ 3
(\\3 4
$str\\4 <
,\\< =
$str\\> `
)\\` a
;\\a b
if^^ 
(^^ 
astrKey^^ 
.^^ 
Length^^ "
!=^^# %
$num^^& (
)^^( )
throw__ 
new__ 
ArgumentException__ /
(__/ 0
$str__0 Q
,__Q R
$str__S \
)__\ ]
;__] ^
if`` 
(`` 
astrIV`` 
.`` 
Length`` !
!=``" $
$num``% '
)``' (
throwaa 
newaa 
ArgumentExceptionaa /
(aa/ 0
$straa0 P
,aaP Q
$straaR Z
)aaZ [
;aa[ \
astrTextcc 
=cc 
stringcc !
.cc! "
Emptycc" '
;cc' (
usingee 
(ee 

AesManagedee !
aesAlgee" (
=ee) *
newee+ .

AesManagedee/ 9
(ee9 :
)ee: ;
)ee; <
{ff 
aesAlghh 
.hh 
KeySizehh "
=hh# $
$numhh% (
;hh( )
aesAlgii 
.ii 
Keyii 
=ii  
ASCIIEncodingii! .
.ii. /
ASCIIii/ 4
.ii4 5
GetBytesii5 =
(ii= >
astrKeyii> E
)iiE F
;iiF G
aesAlgjj 
.jj 
IVjj 
=jj 
ASCIIEncodingjj  -
.jj- .
ASCIIjj. 3
.jj3 4
GetBytesjj4 <
(jj< =
astrIVjj= C
)jjC D
;jjD E
bytemm 
[mm 
]mm 

cryptoBytemm %
=mm& '
Convertmm( /
.mm/ 0
FromBase64Stringmm0 @
(mm@ A
astrEncryptedmmA N
)mmN O
;mmO P
ICryptoTransformpp $
	decryptorpp% .
=pp/ 0
aesAlgpp1 7
.pp7 8
CreateDecryptorpp8 G
(ppG H
aesAlgppH N
.ppN O
KeyppO R
,ppR S
aesAlgppT Z
.ppZ [
IVpp[ ]
)pp] ^
;pp^ _
usingss 
(ss 
MemoryStreamss '
	msDecryptss( 1
=ss2 3
newss4 7
MemoryStreamss8 D
(ssD E

cryptoBytessE O
)ssO P
)ssP Q
{tt 
usinguu 
(uu 
CryptoStreamuu +
	csDecryptuu, 5
=uu6 7
newuu8 ;
CryptoStreamuu< H
(uuH I
	msDecryptuuI R
,uuR S
	decryptoruuT ]
,uu] ^
CryptoStreamModeuu_ o
.uuo p
Readuup t
)uut u
)uuu v
{vv 
usingww !
(ww" #
StreamReaderww# /
	srDecryptww0 9
=ww: ;
newww< ?
StreamReaderww@ L
(wwL M
	csDecryptwwM V
)wwV W
)wwW X
{xx 
astrTextzz  (
=zz) *
	srDecryptzz+ 4
.zz4 5
	ReadToEndzz5 >
(zz> ?
)zz? @
;zz@ A
}{{ 
}|| 
}}} 
}~~ 
} 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
astrText
‚‚ 
=
‚‚ 
string
‚‚ !
.
‚‚! "
Empty
‚‚" '
;
‚‚' (
}
ƒƒ 
}
‡‡ 	
[
ŠŠ 	
SqlProcedure
ŠŠ	 
]
ŠŠ 
public
‹‹ 
static
‹‹ 
string
‹‹ 
OpusEncryptR
‹‹ )
(
‹‹) *
string
‹‹* 0
astrText
‹‹1 9
)
‹‹9 :
{
ŒŒ 	
string
 
astrEncrypted
  
;
  !
astrEncrypted
 
=
 
string
 "
.
" #
Empty
# (
;
( )
string
 
astrKey
 
=
 
$str
 ?
;
? @
string
A G
astrIV
H N
=
O P
$str
Q c
;
c d
try
‘‘ 
{
’’ 
if
–– 
(
–– 
string
–– 
.
–– 
IsNullOrEmpty
–– (
(
––( )
astrText
––) 1
)
––1 2
)
––2 3
astrEncrypted
—— !
=
——" #
string
——$ *
.
——* +
Empty
——+ 0
;
——0 1
if
™™ 
(
™™ 
string
™™ 
.
™™ 
IsNullOrEmpty
™™ (
(
™™( )
astrKey
™™) 0
)
™™0 1
)
™™1 2
throw
šš 
new
šš #
ArgumentNullException
šš 3
(
šš3 4
$str
šš4 =
,
šš= >
$str
šš? a
)
šša b
;
ššb c
if
›› 
(
›› 
string
›› 
.
›› 
IsNullOrEmpty
›› (
(
››( )
astrIV
››) /
)
››/ 0
)
››0 1
throw
œœ 
new
œœ #
ArgumentNullException
œœ 3
(
œœ3 4
$str
œœ4 <
,
œœ< =
$str
œœ> `
)
œœ` a
;
œœa b
if
žž 
(
žž 
astrKey
žž 
.
žž 
Length
žž "
!=
žž# %
$num
žž& (
)
žž( )
throw
ŸŸ 
new
ŸŸ 
ArgumentException
ŸŸ /
(
ŸŸ/ 0
$str
ŸŸ0 Q
,
ŸŸQ R
$str
ŸŸS \
)
ŸŸ\ ]
;
ŸŸ] ^
if
   
(
   
astrIV
   
.
   
Length
   !
!=
  " $
$num
  % '
)
  ' (
throw
¡¡ 
new
¡¡ 
ArgumentException
¡¡ /
(
¡¡/ 0
$str
¡¡0 P
,
¡¡P Q
$str
¡¡R Z
)
¡¡Z [
;
¡¡[ \
string
££ 

lstrResult
££ !
=
££" #
string
££$ *
.
££* +
Empty
££+ 0
;
££0 1
using
¥¥ 
(
¥¥ 

AesManaged
¥¥ !
aesAlg
¥¥" (
=
¥¥) *
new
¥¥+ .

AesManaged
¥¥/ 9
(
¥¥9 :
)
¥¥: ;
)
¥¥; <
{
¦¦ 
aesAlg
¨¨ 
.
¨¨ 
KeySize
¨¨ "
=
¨¨# $
$num
¨¨% (
;
¨¨( )
aesAlg
©© 
.
©© 
Key
©© 
=
©©  
ASCIIEncoding
©©! .
.
©©. /
ASCII
©©/ 4
.
©©4 5
GetBytes
©©5 =
(
©©= >
astrKey
©©> E
)
©©E F
;
©©F G
aesAlg
ªª 
.
ªª 
IV
ªª 
=
ªª 
ASCIIEncoding
ªª  -
.
ªª- .
ASCII
ªª. 3
.
ªª3 4
GetBytes
ªª4 <
(
ªª< =
astrIV
ªª= C
)
ªªC D
;
ªªD E
ICryptoTransform
­­ $
	encryptor
­­% .
=
­­/ 0
aesAlg
­­1 7
.
­­7 8
CreateEncryptor
­­8 G
(
­­G H
aesAlg
­­H N
.
­­N O
Key
­­O R
,
­­R S
aesAlg
­­T Z
.
­­Z [
IV
­­[ ]
)
­­] ^
;
­­^ _
using
°° 
(
°° 
MemoryStream
°° '
	msEncrypt
°°( 1
=
°°2 3
new
°°4 7
MemoryStream
°°8 D
(
°°D E
)
°°E F
)
°°F G
{
±± 
using
²² 
(
²² 
CryptoStream
²² +
	csEncrypt
²², 5
=
²²6 7
new
²²8 ;
CryptoStream
²²< H
(
²²H I
	msEncrypt
²²I R
,
²²R S
	encryptor
²²T ]
,
²²] ^
CryptoStreamMode
²²_ o
.
²²o p
Write
²²p u
)
²²u v
)
²²v w
{
³³ 
using
´´ !
(
´´" #
StreamWriter
´´# /
	swEncrypt
´´0 9
=
´´: ;
new
´´< ?
StreamWriter
´´@ L
(
´´L M
	csEncrypt
´´M V
)
´´V W
)
´´W X
{
µµ 
	swEncrypt
··  )
.
··) *
Write
··* /
(
··/ 0
astrText
··0 8
)
··8 9
;
··9 :
}
¸¸ 
byte
ºº  
[
ºº  !
]
ºº! "

cryptoByte
ºº# -
=
ºº. /
	msEncrypt
ºº0 9
.
ºº9 :
ToArray
ºº: A
(
ººA B
)
ººB C
;
ººC D

lstrResult
»» &
=
»»' (
Convert
»») 0
.
»»0 1
ToBase64String
»»1 ?
(
»»? @

cryptoByte
»»@ J
,
»»J K
$num
»»L M
,
»»M N

cryptoByte
»»O Y
.
»»Y Z
	GetLength
»»Z c
(
»»c d
$num
»»d e
)
»»e f
)
»»f g
;
»»g h
}
¼¼ 
}
½½ 
}
¾¾ 
astrEncrypted
ÁÁ 
=
ÁÁ 

lstrResult
ÁÁ  *
;
ÁÁ* +
return
ÂÂ 
astrEncrypted
ÂÂ $
;
ÂÂ$ %
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
astrEncrypted
ÆÆ 
=
ÆÆ 
string
ÆÆ  &
.
ÆÆ& '
Empty
ÆÆ' ,
;
ÆÆ, -
return
ÇÇ 
astrEncrypted
ÇÇ $
;
ÇÇ$ %
}
ÈÈ 
}
ÊÊ 	
[
ÍÍ 	
SqlProcedure
ÍÍ	 
]
ÍÍ 
public
ÎÎ 
static
ÎÎ 
SqlDateTime
ÎÎ !
OpusDecryptR
ÎÎ" .
(
ÎÎ. /
string
ÎÎ/ 5
astrEncrypted
ÎÎ6 C
)
ÎÎC D
{
ÏÏ 	
string
ÑÑ 
astrText
ÑÑ 
;
ÑÑ 
string
ÒÒ 
astrKey
ÒÒ 
=
ÒÒ 
$str
ÒÒ ?
;
ÒÒ? @
string
ÒÒA G
astrIV
ÒÒH N
=
ÒÒO P
$str
ÒÒQ c
;
ÒÒc d
try
ÔÔ 
{
ÕÕ 
if
ÖÖ 
(
ÖÖ 
string
ÖÖ 
.
ÖÖ 
IsNullOrEmpty
ÖÖ (
(
ÖÖ( )
astrEncrypted
ÖÖ) 6
)
ÖÖ6 7
)
ÖÖ7 8
{
×× 
astrText
ØØ 
=
ØØ 
string
ØØ %
.
ØØ% &
Empty
ØØ& +
;
ØØ+ ,
return
ÙÙ 
System
ÙÙ !
.
ÙÙ! "
Data
ÙÙ" &
.
ÙÙ& '
SqlTypes
ÙÙ' /
.
ÙÙ/ 0
SqlDateTime
ÙÙ0 ;
.
ÙÙ; <
MinValue
ÙÙ< D
.
ÙÙD E
Value
ÙÙE J
;
ÙÙJ K
}
ÚÚ 
if
ÜÜ 
(
ÜÜ 
string
ÜÜ 
.
ÜÜ 
IsNullOrEmpty
ÜÜ (
(
ÜÜ( )
astrKey
ÜÜ) 0
)
ÜÜ0 1
)
ÜÜ1 2
throw
ÝÝ 
new
ÝÝ #
ArgumentNullException
ÝÝ 3
(
ÝÝ3 4
$str
ÝÝ4 =
,
ÝÝ= >
$str
ÝÝ? a
)
ÝÝa b
;
ÝÝb c
if
ÞÞ 
(
ÞÞ 
string
ÞÞ 
.
ÞÞ 
IsNullOrEmpty
ÞÞ (
(
ÞÞ( )
astrIV
ÞÞ) /
)
ÞÞ/ 0
)
ÞÞ0 1
throw
ßß 
new
ßß #
ArgumentNullException
ßß 3
(
ßß3 4
$str
ßß4 <
,
ßß< =
$str
ßß> `
)
ßß` a
;
ßßa b
if
áá 
(
áá 
astrKey
áá 
.
áá 
Length
áá "
!=
áá# %
$num
áá& (
)
áá( )
throw
ââ 
new
ââ 
ArgumentException
ââ /
(
ââ/ 0
$str
ââ0 Q
,
ââQ R
$str
ââS \
)
ââ\ ]
;
ââ] ^
if
ãã 
(
ãã 
astrIV
ãã 
.
ãã 
Length
ãã !
!=
ãã" $
$num
ãã% '
)
ãã' (
throw
ää 
new
ää 
ArgumentException
ää /
(
ää/ 0
$str
ää0 P
,
ääP Q
$str
ääR Z
)
ääZ [
;
ää[ \
astrText
ææ 
=
ææ 
string
ææ !
.
ææ! "
Empty
ææ" '
;
ææ' (
using
èè 
(
èè 

AesManaged
èè !
aesAlg
èè" (
=
èè) *
new
èè+ .

AesManaged
èè/ 9
(
èè9 :
)
èè: ;
)
èè; <
{
éé 
aesAlg
ëë 
.
ëë 
KeySize
ëë "
=
ëë# $
$num
ëë% (
;
ëë( )
aesAlg
ìì 
.
ìì 
Key
ìì 
=
ìì  
ASCIIEncoding
ìì! .
.
ìì. /
ASCII
ìì/ 4
.
ìì4 5
GetBytes
ìì5 =
(
ìì= >
astrKey
ìì> E
)
ììE F
;
ììF G
aesAlg
íí 
.
íí 
IV
íí 
=
íí 
ASCIIEncoding
íí  -
.
íí- .
ASCII
íí. 3
.
íí3 4
GetBytes
íí4 <
(
íí< =
astrIV
íí= C
)
ííC D
;
ííD E
byte
ðð 
[
ðð 
]
ðð 

cryptoByte
ðð %
=
ðð& '
Convert
ðð( /
.
ðð/ 0
FromBase64String
ðð0 @
(
ðð@ A
astrEncrypted
ððA N
)
ððN O
;
ððO P
ICryptoTransform
óó $
	decryptor
óó% .
=
óó/ 0
aesAlg
óó1 7
.
óó7 8
CreateDecryptor
óó8 G
(
óóG H
aesAlg
óóH N
.
óóN O
Key
óóO R
,
óóR S
aesAlg
óóT Z
.
óóZ [
IV
óó[ ]
)
óó] ^
;
óó^ _
using
öö 
(
öö 
MemoryStream
öö '
	msDecrypt
öö( 1
=
öö2 3
new
öö4 7
MemoryStream
öö8 D
(
ööD E

cryptoByte
ööE O
)
ööO P
)
ööP Q
{
÷÷ 
using
øø 
(
øø 
CryptoStream
øø +
	csDecrypt
øø, 5
=
øø6 7
new
øø8 ;
CryptoStream
øø< H
(
øøH I
	msDecrypt
øøI R
,
øøR S
	decryptor
øøT ]
,
øø] ^
CryptoStreamMode
øø_ o
.
øøo p
Read
øøp t
)
øøt u
)
øøu v
{
ùù 
using
úú !
(
úú" #
StreamReader
úú# /
	srDecrypt
úú0 9
=
úú: ;
new
úú< ?
StreamReader
úú@ L
(
úúL M
	csDecrypt
úúM V
)
úúV W
)
úúW X
{
ûû 
astrText
ýý  (
=
ýý) *
	srDecrypt
ýý+ 4
.
ýý4 5
	ReadToEnd
ýý5 >
(
ýý> ?
)
ýý? @
;
ýý@ A
if
þþ  "
(
þþ# $
Convert
þþ$ +
.
þþ+ ,

ToDateTime
þþ, 6
(
þþ6 7
astrText
þþ7 ?
)
þþ? @
==
þþA C
DateTime
þþD L
.
þþL M
MinValue
þþM U
)
þþU V
{
ÿÿ  !
return
€€$ *
System
€€+ 1
.
€€1 2
Data
€€2 6
.
€€6 7
SqlTypes
€€7 ?
.
€€? @
SqlDateTime
€€@ K
.
€€K L
MinValue
€€L T
.
€€T U
Value
€€U Z
;
€€Z [
}
  !
else
‚‚  $
{
ƒƒ  !
return
„„$ *
Convert
„„+ 2
.
„„2 3

ToDateTime
„„3 =
(
„„= >
astrText
„„> F
)
„„F G
;
„„G H
}
……  !
}
†† 
}
‡‡ 
}
ˆˆ 
}
‰‰ 
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
astrText
 
=
 
string
 !
.
! "
Empty
" '
;
' (
return
ŽŽ 
System
ŽŽ 
.
ŽŽ 
Data
ŽŽ "
.
ŽŽ" #
SqlTypes
ŽŽ# +
.
ŽŽ+ ,
SqlDateTime
ŽŽ, 7
.
ŽŽ7 8
MinValue
ŽŽ8 @
.
ŽŽ@ A
Value
ŽŽA F
;
ŽŽF G
}
 
}
““ 	
[
•• 	
SqlProcedure
••	 
]
•• 
public
–– 
static
–– 
string
–– 
OpusDecryptString
–– .
(
––. /
string
––/ 5
astrEncrypted
––6 C
)
––C D
{
—— 	
string
™™ 
astrText
™™ 
;
™™ 
string
šš 
astrKey
šš 
=
šš 
$str
šš ?
;
šš? @
string
ššA G
astrIV
ššH N
=
ššO P
$str
ššQ c
;
ššc d
try
œœ 
{
 
if
žž 
(
žž 
string
žž 
.
žž 
IsNullOrEmpty
žž (
(
žž( )
astrEncrypted
žž) 6
)
žž6 7
)
žž7 8
{
ŸŸ 
astrText
   
=
   
string
   %
.
  % &
Empty
  & +
;
  + ,
return
¡¡ 
string
¡¡ !
.
¡¡! "
Empty
¡¡" '
;
¡¡' (
}
¢¢ 
if
¤¤ 
(
¤¤ 
string
¤¤ 
.
¤¤ 
IsNullOrEmpty
¤¤ (
(
¤¤( )
astrKey
¤¤) 0
)
¤¤0 1
)
¤¤1 2
throw
¥¥ 
new
¥¥ #
ArgumentNullException
¥¥ 3
(
¥¥3 4
$str
¥¥4 =
,
¥¥= >
$str
¥¥? a
)
¥¥a b
;
¥¥b c
if
¦¦ 
(
¦¦ 
string
¦¦ 
.
¦¦ 
IsNullOrEmpty
¦¦ (
(
¦¦( )
astrIV
¦¦) /
)
¦¦/ 0
)
¦¦0 1
throw
§§ 
new
§§ #
ArgumentNullException
§§ 3
(
§§3 4
$str
§§4 <
,
§§< =
$str
§§> `
)
§§` a
;
§§a b
if
©© 
(
©© 
astrKey
©© 
.
©© 
Length
©© "
!=
©©# %
$num
©©& (
)
©©( )
throw
ªª 
new
ªª 
ArgumentException
ªª /
(
ªª/ 0
$str
ªª0 Q
,
ªªQ R
$str
ªªS \
)
ªª\ ]
;
ªª] ^
if
«« 
(
«« 
astrIV
«« 
.
«« 
Length
«« !
!=
««" $
$num
««% '
)
««' (
throw
¬¬ 
new
¬¬ 
ArgumentException
¬¬ /
(
¬¬/ 0
$str
¬¬0 P
,
¬¬P Q
$str
¬¬R Z
)
¬¬Z [
;
¬¬[ \
astrText
®® 
=
®® 
string
®® !
.
®®! "
Empty
®®" '
;
®®' (
using
°° 
(
°° 

AesManaged
°° !
aesAlg
°°" (
=
°°) *
new
°°+ .

AesManaged
°°/ 9
(
°°9 :
)
°°: ;
)
°°; <
{
±± 
aesAlg
³³ 
.
³³ 
KeySize
³³ "
=
³³# $
$num
³³% (
;
³³( )
aesAlg
´´ 
.
´´ 
Key
´´ 
=
´´  
ASCIIEncoding
´´! .
.
´´. /
ASCII
´´/ 4
.
´´4 5
GetBytes
´´5 =
(
´´= >
astrKey
´´> E
)
´´E F
;
´´F G
aesAlg
µµ 
.
µµ 
IV
µµ 
=
µµ 
ASCIIEncoding
µµ  -
.
µµ- .
ASCII
µµ. 3
.
µµ3 4
GetBytes
µµ4 <
(
µµ< =
astrIV
µµ= C
)
µµC D
;
µµD E
byte
¸¸ 
[
¸¸ 
]
¸¸ 

cryptoByte
¸¸ %
=
¸¸& '
Convert
¸¸( /
.
¸¸/ 0
FromBase64String
¸¸0 @
(
¸¸@ A
astrEncrypted
¸¸A N
)
¸¸N O
;
¸¸O P
ICryptoTransform
»» $
	decryptor
»»% .
=
»»/ 0
aesAlg
»»1 7
.
»»7 8
CreateDecryptor
»»8 G
(
»»G H
aesAlg
»»H N
.
»»N O
Key
»»O R
,
»»R S
aesAlg
»»T Z
.
»»Z [
IV
»»[ ]
)
»»] ^
;
»»^ _
using
¾¾ 
(
¾¾ 
MemoryStream
¾¾ '
	msDecrypt
¾¾( 1
=
¾¾2 3
new
¾¾4 7
MemoryStream
¾¾8 D
(
¾¾D E

cryptoByte
¾¾E O
)
¾¾O P
)
¾¾P Q
{
¿¿ 
using
ÀÀ 
(
ÀÀ 
CryptoStream
ÀÀ +
	csDecrypt
ÀÀ, 5
=
ÀÀ6 7
new
ÀÀ8 ;
CryptoStream
ÀÀ< H
(
ÀÀH I
	msDecrypt
ÀÀI R
,
ÀÀR S
	decryptor
ÀÀT ]
,
ÀÀ] ^
CryptoStreamMode
ÀÀ_ o
.
ÀÀo p
Read
ÀÀp t
)
ÀÀt u
)
ÀÀu v
{
ÁÁ 
using
ÂÂ !
(
ÂÂ" #
StreamReader
ÂÂ# /
	srDecrypt
ÂÂ0 9
=
ÂÂ: ;
new
ÂÂ< ?
StreamReader
ÂÂ@ L
(
ÂÂL M
	csDecrypt
ÂÂM V
)
ÂÂV W
)
ÂÂW X
{
ÃÃ 
astrText
ÅÅ  (
=
ÅÅ) *
	srDecrypt
ÅÅ+ 4
.
ÅÅ4 5
	ReadToEnd
ÅÅ5 >
(
ÅÅ> ?
)
ÅÅ? @
;
ÅÅ@ A
if
ÆÆ  "
(
ÆÆ# $
astrText
ÆÆ$ ,
==
ÆÆ- /
string
ÆÆ0 6
.
ÆÆ6 7
Empty
ÆÆ7 <
)
ÆÆ< =
{
ÇÇ  !
return
ÈÈ$ *
string
ÈÈ+ 1
.
ÈÈ1 2
Empty
ÈÈ2 7
;
ÈÈ7 8
}
ÉÉ  !
else
ÊÊ  $
{
ËË  !
return
ÌÌ$ *
astrText
ÌÌ+ 3
;
ÌÌ3 4
}
ÍÍ  !
}
ÎÎ 
}
ÏÏ 
}
ÐÐ 
}
ÑÑ 
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
astrText
ÕÕ 
=
ÕÕ 
string
ÕÕ !
.
ÕÕ! "
Empty
ÕÕ" '
;
ÕÕ' (
return
ÖÖ 
string
ÖÖ 
.
ÖÖ 
Empty
ÖÖ #
;
ÖÖ# $
}
×× 
}
ÛÛ 	
}
ÝÝ 
}ÞÞ 